<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>我的命題列表 - CWT 命題工作平臺</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="css/css-reset.css">
  <link rel="stylesheet" href="css/cwt-list.css">
  <link rel="stylesheet" href="css/quill.snow.css">
  <link rel="stylesheet" href="css/sweetalert2.css">
  <style>
    /* === QUILL 設定 === */
    /* Quill 編輯器高度設定 */
    .ql-container {
      font-family: "Noto Sans TC", sans-serif;
      font-size: 1rem;
    }

    /* 1. 設定外層容器：讓它高度自動，不要寫死 */
    #q-editor-content,
    #q-editor-explanation,
    #q-reading-main,
    #q-long-content,
    #q-long-explanation,
    #q-short-main,
    #q-listen-content,
    #q-listen-explanation,
    #q-listen-ref-answer,
    #q-listengroup-content,
    #q-listengroup-explanation {
      height: auto !important;
      /* 高度自動 */
      max-height: none !important;
      /* ★ 關鍵：解除外層的高度限制 */
      border: none !important;
      /* 邊框交給 quill-master-container */
    }

    /* 2. 設定內層編輯區 (.ql-editor)：控制卷軸邏輯 */
    #q-editor-content .ql-editor,
    #q-editor-explanation .ql-editor,
    #q-reading-main .ql-editor,
    #q-long-content .ql-editor,
    #q-long-explanation .ql-editor,
    #q-short-main .ql-editor,
    #q-listen-content .ql-editor,
    #q-listen-explanation .ql-editor,
    #q-listen-ref-answer .ql-editor,
    #q-listengroup-content .ql-editor,
    #q-listengroup-explanation .ql-editor {
      min-height: 150px;
      /* 預設高度 */
      max-height: 200px;
      /* ★ 這裡設定您要的最大高度 (例如 300px) */
      overflow-y: auto;
      /* ★ 超過 300px 時，卷軸出現在這裡 */
    }

    /* 選項的高度 (比較矮) */
    .option-editor {
      min-height: 100px;
      max-height: 150px;
      height: auto !important;
    }

    /* 調整選項區塊的標頭 */
    .option-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
      background-color: #f8f9fa;
      padding: 5px 10px;
      border-radius: 4px;
      border: 1px solid #dee2e6;
    }

    .ql-editor.ql-blank:focus::before {
      opacity: 0;
    }

    /* 1. 定義編輯器內的字體樣式 */
    .ql-font-microsoft-jhenghei {
      font-family: "Microsoft JhengHei", "微軟正黑體", sans-serif;
    }

    .ql-font-kaiu {
      font-family: "DFKai-SB", "標楷體", serif;
    }

    .ql-font-times-new-roman {
      font-family: "Times New Roman", serif;
    }

    .ql-font-arial {
      font-family: "Arial", sans-serif;
    }

    .ql-font-comic-sans-ms {
      font-family: "Comic Sans MS", cursive;
    }

    /* 2. 設定下拉選單的「標籤名稱」 (這是給人看的) */
    /* === 修正 Quill 字體選單寬度不足的問題 === */
    .ql-snow .ql-picker.ql-font {
      width: 160px !important;
    }

    /* 如果選單展開後的選項也太窄，可以一併調整 (通常上面那行就夠了) */
    .ql-snow .ql-picker.ql-font .ql-picker-label,
    .ql-snow .ql-picker.ql-font .ql-picker-item {
      padding-right: 20px;
    }

    /* 讓選單裡面的選項顯示中文，如果不加這些，它只會顯示空白或預設樣式 */
    /* 選單標題 (選中時) */
    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="microsoft-jhenghei"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="microsoft-jhenghei"]::before {
      content: "微軟正黑體";
      font-family: "Microsoft JhengHei";
    }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="kaiu"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="kaiu"]::before {
      content: "標楷體";
      font-family: "DFKai-SB";
    }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="times-new-roman"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="times-new-roman"]::before {
      content: "Times New Roman";
      font-family: "Times New Roman";
    }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="arial"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="arial"]::before {
      content: "Arial";
      font-family: "Arial";
    }

    .ql-snow .ql-picker.ql-font .ql-picker-label[data-value="comic-sans-ms"]::before,
    .ql-snow .ql-picker.ql-font .ql-picker-item[data-value="comic-sans-ms"]::before {
      content: "Comic Sans";
      font-family: "Comic Sans MS";
    }

    /* === QUILL 設定結束 === */
    :root {
      --primary-blue: #2563eb;
      --bg-color: #f0f2f5;
      --text-dark: #1f2937;
      --text-gray: #6b7280;
    }

    body {
      font-family: "Noto Sans TC", sans-serif;
      background-color: var(--bg-color);
      color: var(--text-dark);
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }


    /* =========================================
   狀態列樣式區隔
   ========================================= */
    .form-check-input {
      cursor: pointer;
    }

    /* 1. 鎖定狀態 (命題送審 / 不採用) */
    /* 使用淺灰色背景，讓文字變淡，營造無法編輯的感覺 */
    .row-locked {
      background-color: #f8f9fa !important;
      /* 淺灰背景 */
      color: #adb5bd !important;
      /* 文字變淡 */
    }

    /* 2. 讓該行的一般連結 (如標題) 失效 */
    .row-locked a.fw-bold {
      color: #adb5bd !important;
      pointer-events: none;
      /* 禁止點擊標題 */
      text-decoration: none;
    }

    /* 3. 讓 Checkbox 看起來是停用的 */
    .row-locked .form-check-input {
      background-color: #e9ecef;
      border-color: #dee2e6;
      opacity: 0.5;
      pointer-events: none;
      /* 禁止點擊 Checkbox */
    }

    /* 4. 讓「檢視」按鈕恢復可點擊 */
    .row-locked button {
      pointer-events: auto !important;
      cursor: pointer;
      color: #3b82f6 !important;
      opacity: 1 !important;
    }

    /* =========================================
         原有的樣式保留 (Breadcrumb, Main Content)
         ========================================= */

    /* 3. 主要內容區 */
    .main-content {
      padding: 2rem 0;
      flex-grow: 1;
    }

    .page-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #111827;
      margin-bottom: 0.25rem;
    }

    .page-desc {
      color: var(--text-gray);
      font-size: 0.95rem;
      margin-bottom: 1.5rem;
    }

    /* 通用卡片樣式 */
    .card-box {
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      border: 1px solid #e5e7eb;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    /* 搜尋區 */
    .search-area .input-group-text {
      display: flex;
      align-items: center;
    }

    .search-area .form-label {
      font-size: 0.85rem;
      font-weight: 700;
      color: #374151;
      margin-bottom: 0.4rem;
    }

    .search-area .form-select,
    .search-area .form-control {
      background-color: #f9fafb;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      padding: 0.6rem 1rem;
      font-size: 0.95rem;
    }

    .btn-search {
      background-color: #2563eb;
      color: white;
      border-radius: 8px;
      font-weight: 600;
      padding: 0.6rem 1.5rem;
      border: none;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .btn-search:hover {
      background-color: #1d4ed8;
    }

    /* 統計卡片區 */
    .stat-card {
      background: white;
      border-radius: 12px;
      padding: 1.25rem;
      border: 1px solid #e5e7eb;
      display: flex;
      align-items: center;
      height: 100%;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 1rem;
      flex-shrink: 0;
    }

    .stat-info span {
      display: block;
      color: #6b7280;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.2rem;
    }

    .stat-info h4 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      line-height: 1;
    }

    /* 統計圖示顏色 */
    .icon-gray {
      background-color: #f3f4f6;
      color: #6b7280;
    }

    .icon-orange {
      background-color: #fff7ed;
      color: #f97316;
    }

    .icon-green {
      background-color: #f0fdf4;
      color: #10b981;
    }

    .icon-blue {
      background-color: #eff6ff;
      color: #3b82f6;
    }

    /* 列表區 */
    .table-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 1rem;
    }

    .btn-outline-blue {
      border: 1px solid #2563eb;
      color: #2563eb;
      background: white;
      font-weight: 600;
      border-radius: 6px;
      padding: 0.4rem 1rem;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn-outline-blue:hover {
      background-color: #eff6ff;
    }

    /* 新的工具列按鈕樣式：取代原本的 btn-toolbar-gray */
    .btn-tool {
      background: white;
      border: 1px solid #d1d5db;
      /* 邊框深灰色，比較有實體感 */
      color: #374151;
      /* 文字改為深灰色，看起來是「可用」的 */
      font-weight: 600;
      border-radius: 6px;
      padding: 0.4rem 1rem;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      /* 增加一點圖示跟文字的間距 */
      transition: all 0.2s ease;
      /* 加入平滑過渡動畫 */
    }

    /* 滑鼠移上去的效果 (Hover) */
    .btn-tool:hover,
    .btn-tool:focus,
    .btn-tool[aria-expanded="true"] {
      /* 下拉選單打開時也保持藍色 */
      border-color: #2563eb;
      color: #2563eb;
      background-color: #eff6ff;
      /* 非常淡的藍色背景 */
      box-shadow: 0 2px 4px rgba(37, 99, 235, 0.1);
      /* 輕微的藍色陰影 */
    }

    /* 按鈕內的假 Checkbox 方塊樣式優化 */
    .icon-checkbox {
      display: inline-block;
      width: 14px;
      height: 14px;
      border: 2px solid #9ca3af;
      /* 預設邊框 */
      border-radius: 3px;
      transition: all 0.2s;
    }

    /* 當按鈕 Hover 時，那個小方塊也要變色 */
    .btn-tool:hover .icon-checkbox {
      border-color: #2563eb;
    }

    /* 表格樣式 */
    .custom-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }

    .custom-table th {
      background-color: #f3f4f6;
      color: #374151;
      font-weight: 700;
      padding: 1rem;
      font-size: 0.9rem;
      border-bottom: 2px solid #e5e7eb;
      text-align: left;
    }

    .custom-table td {
      padding: 1rem;
      vertical-align: middle;
      border-bottom: 1px solid #f3f4f6;
      color: #4b5563;
      font-size: 0.95rem;
    }

    .custom-table tr:hover td {
      background-color: #f9fafb;
    }

    /* 狀態標籤 */
    /* 狀態徽章 (Premium Redesign) */
    .badge-outline {
      padding: 0.35em 0.8em;
      border-radius: 50rem;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid transparent;
    }

    .badge-outline::before {
      content: '';
      display: inline-block;
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }

    .badge-draft {
      background-color: rgba(253, 126, 20, 0.1);
      color: #fd7e14;
      border-color: rgba(253, 126, 20, 0.2);
    }

    .badge-draft::before {
      background-color: #fd7e14;
    }

    .badge-confirmed {
      background-color: rgba(25, 135, 84, 0.1);
      color: #198754;
      border-color: rgba(25, 135, 84, 0.2);
    }

    .badge-confirmed::before {
      background-color: #198754;
    }

    .badge-sent {
      background-color: rgba(13, 110, 253, 0.1);
      color: #0d6efd;
      border-color: rgba(13, 110, 253, 0.2);
    }

    .badge-sent::before {
      background-color: #0d6efd;
    }

    .badge-returned {
      background-color: rgba(249, 115, 22, 0.1);
      color: #f97316;
      border-color: rgba(249, 115, 22, 0.2);
    }

    .badge-returned::before {
      background-color: #f97316;
    }

    .badge-rejected {
      background-color: rgba(107, 114, 128, 0.1);
      color: #6b7280;
      border-color: rgba(107, 114, 128, 0.2);
    }

    .badge-rejected::before {
      background-color: #6b7280;
    }

    /* 操作連結 */
    .action-links a {
      color: #2563eb;
      text-decoration: none;
      font-weight: 500;
      font-size: 0.9rem;
    }

    .action-links a:hover {
      text-decoration: underline;
    }

    .action-divider {
      color: #d1d5db;
      margin: 0 4px;
    }

    /* Tooltip */
    .custom-tooltip .tooltip-inner {
      background-color: #1f2937;
      color: white;
      padding: 10px 15px;
      border-radius: 6px;
      font-size: 0.85rem;
      max-width: 280px;
      text-align: left;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    /* 分頁 */
    .pagination-container {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      margin-top: 1rem;
      gap: 10px;
    }

    .page-info {
      color: #6b7280;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .page-btn {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #e5e7eb;
      border-radius: 4px;
      color: #6b7280;
      text-decoration: none;
      background: white;
      font-size: 0.9rem;
    }

    .page-btn.active {
      background-color: #2563eb;
      color: white;
      border-color: #2563eb;
    }

    .page-btn:hover:not(.active) {
      background-color: #f3f4f6;
    }

    .hover-effect:active {
      transform: scale(0.9);
      /* 點擊時稍微縮小 */
    }

    /* =========== */
    /* 一般題型樣式 */
    /* =========== */
    /* 必填星號 */
    .required-star::after {
      content: " *";
      color: #dc3545;
    }

    /* 選項輸入框優化 */
    .question-form-group .input-group-text {
      border-color: #dee2e6;
    }

    .question-form-group .form-control:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.15);
    }

    /* 選項卡片樣式 Redesign */
    .option-card {
      border-radius: 8px !important;
      border: 1px solid #e5e7eb;
      background-color: white;
      transition: all 0.2s ease;
      position: relative;
    }

    .option-header-styled {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0.75rem;
      background-color: #f9fafb;
      border-bottom: 0;
      transition: background-color 0.2s;
      border-top-left-radius: 8px !important;
      border-top-right-radius: 8px !important;
    }

    .option-header-styled:hover {
      background-color: #f3f4f6;
    }

    /* === 使用 CSS :has 選擇器處理選取狀態 (無需 JS) === */

    /* 1. 外框與陰影：當內部 radio 被選中時 */
    .option-card:has(input[type="radio"]:checked) {
      border-color: #10b981;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);
      z-index: 2;
      /* 輕微綠色陰影 */
      /* 不再顯示左側綠色 border */
    }

    /* 2. 標頭變色 */
    /* 2. 標頭變色 */
    .option-card:has(input[type="radio"]:checked) .option-header-styled {
      background-color: #f9fafb;
      /* 極淡綠色標題 -> 改回預設 */
      border-bottom-color: #86efac;
    }

    /* 3. 文字變色 */
    .option-card:has(input[type="radio"]:checked) .form-check-label {
      color: #059669 !important;
      font-weight: 800 !important;
    }

    /* 4. ★★★ 關鍵修正：確保編輯器區域永遠維持白色背景 ★★★ */
    /* 強制覆蓋任何可能繼承的背景色 */
    .question-form-group .ql-toolbar,
    .question-form-group .ql-container,
    .option-editor,
    .option-card:has(input[type="radio"]:checked) .ql-toolbar,
    .option-card:has(input[type="radio"]:checked) .ql-container {
      background-color: white !important;
      border-color: #dee2e6 !important;
    }

    /* 移除舊的 input-group 樣式干擾，避免它同時生效 */
    .input-group:has(input[type="radio"]:checked) .form-control {
      background-color: white !important;
      border-color: #dee2e6 !important;
    }

    /* =========================== */
    /* Quill 編輯器樣式優化 (New) */
    /* =========================== */


    .ql-container.ql-snow {
      border: 1px solid #dee2e6;
      border-top: none;
      /* 讓工具列與編輯區相連 */
      background-color: #fff;
      /* 確保內容區是純白，不干擾顏色判斷 */
      font-family: "Times New Roman", "Microsoft JhengHei", serif;
      /* 符合您之前的字體需求 */
      font-size: 1.1rem;
    }

    /* 移除按鈕滑過的強烈顏色，改為柔和的灰色 */
    .ql-snow.ql-toolbar button:hover,
    .ql-snow .ql-toolbar button:hover,
    .ql-snow.ql-toolbar button.ql-active,
    .ql-snow .ql-toolbar button.ql-active {
      color: #0d6efd;
      background-color: #e9ecef;
    }

    /* 調整 Placeholder 顏色，讓它更淡一點 */
    .ql-editor.ql-blank::before {
      color: #adb5bd;
      font-style: normal;
    }

    /* 點擊編輯器時的邊框發亮 (Focus 狀態) */
    .ql-container.ql-snow:focus-within,
    .ql-toolbar.ql-snow:focus-within {
      border-color: #86b7fe;
      outline: 0;
      box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
    }

    /* 選項收合速度 */
    .collapsing {
      transition: height 0.6s ease;
    }

    /* 互動式狀態 Icon */
    .stat-icon.interactive {
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .stat-icon.interactive:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .stat-icon.interactive:active {
      transform: scale(0.95);
    }
  </style>
</head>

<body>
  <nav class="top-navbar">
    <div class="container-fluid px-4">
      <div class="row align-items-center">
        <div class="col-3">
          <a href="firstpage.html" class="navbar-brand">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
            </svg>
            CWT 命題工作平臺
          </a>
        </div>

        <div class="col-6 d-flex justify-content-center">
          <div class="project-switcher">
            <div class="project-display glass-enhanced" id="projectToggle">
              <div class="glass-icon">
                <img src="ICON/calendar.svg" alt="Calendar" style="width: 24px; height: 24px;">
              </div>

              <div class="project-info">
                <div class="project-year" id="currentProjectYear">
                  2024年度
                </div>
                <div class="project-name" id="currentProjectName">
                  進行中梯次範例一
                </div>
              </div>
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path
                  d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
              </svg>
            </div>

            <div class="project-dropdown" id="projectDropdown">
              <div class="dropdown-header">
                <span>切換專案</span>
                <button class="close-btn" id="closeDropdown">
                  <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path
                      d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                  </svg>
                </button>
              </div>

              <div class="project-search">
                <input type="text" placeholder="搜尋專案名稱..." id="projectSearchInput" />
              </div>

              <div class="project-list" id="projectList">
                <div class="project-category">進行中 (3)</div>

                <div class="project-item active" data-project-id="1" data-year="2024" data-name="進行中梯次範例一"
                  data-role="admin">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-active"></span>
                      進行中梯次範例一
                    </div>
                    <div class="project-item-meta">
                      <span>2024年度</span>
                      <span>截止: 2024/12/31</span>
                    </div>
                  </div>
                  <span class="role-badge role-admin">系統管理員</span>
                </div>

                <div class="project-item" data-project-id="2" data-year="2024" data-name="進行中梯次範例二"
                  data-role="reviewer">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-active"></span>
                      進行中梯次範例二
                    </div>
                    <div class="project-item-meta">
                      <span>2024年度</span>
                      <span>截止: 2024/11/15</span>
                    </div>
                  </div>
                  <span class="role-badge role-reviewer">審題委員</span>
                </div>

                <div class="project-item" data-project-id="3" data-year="2024" data-name="進行中梯次範例三" data-role="teacher">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-active"></span>
                      進行中梯次範例三
                    </div>
                    <div class="project-item-meta">
                      <span>2024年度</span>
                      <span>截止: 2025/01/20</span>
                    </div>
                  </div>
                  <span class="role-badge role-teacher">命題教師</span>
                </div>

                <div class="project-category">已結束 (5)</div>

                <div class="project-item" data-project-id="4" data-year="2023" data-name="已結束梯次範例一" data-role="admin">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-finished"></span>
                      已結束梯次範例一
                    </div>
                    <div class="project-item-meta">
                      <span>2023年度</span>
                      <span>已結束</span>
                    </div>
                  </div>
                  <span class="role-badge role-admin">系統管理員</span>
                </div>

                <div class="project-item" data-project-id="5" data-year="2023" data-name="已結束梯次範例二" data-role="teacher">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-finished"></span>
                      已結束梯次範例二
                    </div>
                    <div class="project-item-meta">
                      <span>2023年度</span>
                      <span>已結束</span>
                    </div>
                  </div>
                  <span class="role-badge role-teacher">命題教師</span>
                </div>

                <div class="project-item" data-project-id="6" data-year="2023" data-name="已結束梯次範例三"
                  data-role="reviewer">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-finished"></span>
                      已結束梯次範例三
                    </div>
                    <div class="project-item-meta">
                      <span>2023年度</span>
                      <span>已結束</span>
                    </div>
                  </div>
                  <span class="role-badge role-reviewer">審題委員</span>
                </div>

                <div class="project-item" data-project-id="7" data-year="2022" data-name="已結束梯次範例四" data-role="teacher">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-finished"></span>
                      已結束梯次範例四
                    </div>
                    <div class="project-item-meta">
                      <span>2022年度</span>
                      <span>已結束</span>
                    </div>
                  </div>
                  <span class="role-badge role-teacher">命題教師</span>
                </div>

                <div class="project-item" data-project-id="8" data-year="2022" data-name="已結束梯次範例五" data-role="teacher">
                  <div class="project-item-info">
                    <div class="project-item-title">
                      <span class="status-indicator status-finished"></span>
                      已結束梯次範例五
                    </div>
                    <div class="project-item-meta">
                      <span>2022年度</span>
                      <span>已結束</span>
                    </div>
                  </div>
                  <span class="role-badge role-teacher">命題教師</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div class="user-section">
            <div class="user-info">
              <div class="user-avatar">沈</div>
              <span class="user-name">沈雅茹</span>
              <span class="role-badge role-admin" id="currentUserRole">系統管理員</span>
            </div>
            <a href="index.html" class="btn btn-sm btn-light fw-bold text-primary px-3">
              登出
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <div class="breadcrumb-bar">
    <div class="container-fluid px-4 d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <a href="firstpage.html" class="breadcrumb-item-link">首頁</a>
        <span class="breadcrumb-separator">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
            stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </span>
        <span class="breadcrumb-current">我的命題任務</span>
      </div>

      <div class="bg-white rounded-pill px-2 py-1 border d-flex align-items-center shadow-sm"
        style="width: fit-content;">

        <span class="text-muted d-flex align-items-center me-2 border-end pe-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-type"
            viewBox="0 0 16 16">
            <path
              d="m2.244 13.081.943-2.803H6.66l.944 2.803H8.86L5.54 3.75H4.322L1 13.081zm2.7-7.923L6.34 9.314H3.51l1.4-4.156zm9.146 7.027h.035v.896h1.128V8.125c0-1.51-1.114-2.345-2.646-2.345-1.736 0-2.59.916-2.666 2.174h1.108c.068-.718.595-1.19 1.517-1.19.971 0 1.518.52 1.518 1.464v.731H12.19c-1.647.007-2.522.8-2.522 2.058 0 1.319.957 2.18 2.345 2.18 1.06 0 1.716-.43 2.078-1.011zm-1.763.035c-.752 0-1.456-.397-1.456-1.244 0-.65.424-1.115 1.408-1.115h1.805v.834c0 .896-.752 1.525-1.757 1.525" />
          </svg>
        </span>

        <button
          class="btn btn-sm bg-transparent border-0 p-0 rounded-circle d-flex align-items-center justify-content-center hover-effect"
          style="width: 32px; height: 32px; transition: transform 0.1s;" onclick="changeFontSize(-1)" title="縮小">
          <img src="ICON/minus.png" alt="縮小" style="width: 26px; height: auto;">
        </button>

        <span class="small fw-bold text-secondary mx-2 user-select-none"
          style="cursor: pointer; min-width: 45px; text-align: center; transition: color 0.3s;"
          onclick="resetFontSize()" id="fontSizeDisplay" title="點擊還原預設值">
          100%
        </span>

        <button
          class="btn btn-sm bg-transparent border-0 p-0 rounded-circle d-flex align-items-center justify-content-center hover-effect"
          style="width: 32px; height: 32px; transition: transform 0.1s;" onclick="changeFontSize(1)" title="放大">
          <img src="ICON/add.png" alt="放大" style="width: 28px; height: auto;">
        </button>
      </div>
    </div>
  </div>

  <div class="main-content">
    <div class="container px-4">
      <h1 class="page-title">我的命題任務</h1>
      <p class="page-desc">
        檢視和管理您的所有命題，包括命題草稿、命題完成、命題送審、改後再審與不採用的試題。
      </p>

      <ul class="nav nav-tabs custom-tabs" id="taskTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active fw-bold" id="tab-working" data-bs-toggle="tab" data-tab-type="working"
            type="button">
            <i class="bi bi-pencil-square me-2"></i>命題作業區
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link fw-bold" id="tab-review" data-bs-toggle="tab" data-tab-type="review" type="button">
            <i class="bi bi-clipboard-check me-2"></i>審核結果與歷史
          </button>
        </li>
      </ul>

      <div class="card-box search-area rounded-top-0 px-2">
        <div class="row g-3 align-items-end">
          <div class="col-md-2">
            <label class="form-label">題型篩選</label>
            <select class="form-select" id="filterType">
              <option value="all" selected>全部題型</option>
              <option value="一般題目">一般題目</option>
              <option value="精選題目">精選題目</option>
              <option value="閱讀題組">閱讀題組</option>
              <option value="短文題組">短文題組</option>
              <option value="長文題目">長文題目</option>
              <option value="聽力題目">聽力題目</option>
              <option value="聽力題組">聽力題組</option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label">等級篩選</label>
            <select class="form-select" id="filterLevel">
              <option value="all" selected>全部等級</option>
            </select>
          </div>
          <div class="col-md-2">
            <label class="form-label">狀態篩選</label>
            <select class="form-select" id="filterStatus">
              <option value="all" selected>全部狀態</option>
            </select>
          </div>

          <div class="col-md-6">
            <label class="form-label">關鍵字搜尋</label>
            <div class="d-flex gap-2">
              <div class="input-group">
                <span class="input-group-text bg-white text-secondary border-end-0">
                  <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                  </svg>
                </span>
                <input type="text" id="searchInput" class="form-control border-start-0 ps-2" placeholder="依題目文字搜尋" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="alert alert-info alert-dismissible fade show d-flex align-items-center mb-4 shadow-sm" role="alert"
        style="border-left: 5px solid #0dcaf0;" id="operationHint">
        <svg xmlns="http://www.w3.org/2000/svg" class="bi flex-shrink-0 me-3" width="24" height="24" fill="currentColor"
          viewBox="0 0 16 16">
          <path
            d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z" />
        </svg>
        <div>
          <strong>操作提示：</strong> 點擊下方統計卡片中的 <span class="badge rounded-pill bg-light text-dark border mx-1">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="icon-orange">
              <path
                d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zm0 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1h-4z" />
            </svg>
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="icon-green">
              <path
                d="M5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z" />
              <path fill="white"
                d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z" />
            </svg>
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="icon-blue">
              <path
                d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z" />
            </svg>
            圖示</span> ( 命題草稿、命題完成、命題送審 )，即可將列表選取的項目 <strong class="text-primary">批次變更</strong>
          為該狀態。
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>

      <div id="stats-working" class="row g-4 mb-4">
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('all')">
            <div class="stat-icon icon-gray">
              <i class="bi bi-folder2-open" style="font-size: 1.5rem;"></i>
            </div>
            <div class="stat-info"><span>有效命題總計(含審核中)</span>
              <h4 id="stat-total-working">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('命題草稿')">
            <div class="stat-icon icon-orange interactive" onclick="event.stopPropagation(); batchUpdateStatus('命題草稿')"
              title="批次設為草稿">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path
                  d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zm0 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1h-4z" />
              </svg>
            </div>
            <div class="stat-info"><span>命題草稿</span>
              <h4 id="stat-draft">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('命題完成')">
            <div class="stat-icon icon-green interactive" onclick="event.stopPropagation(); batchUpdateStatus('命題完成')"
              title="批次設為完成">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-check-lg"
                viewBox="0 0 16 16">
                <path
                  d="M5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z" />
                <path fill="white"
                  d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z" />
              </svg>
            </div>
            <div class="stat-info"><span>命題完成</span>
              <h4 id="stat-confirmed">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('命題送審')">
            <div class="stat-icon icon-blue interactive" onclick="event.stopPropagation(); batchUpdateStatus('命題送審')"
              title="批次送審">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-send"
                viewBox="0 0 16 16">
                <path
                  d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z" />
              </svg>
            </div>
            <div class="stat-info"><span>命題送審</span>
              <h4 id="stat-sent">0</h4>
            </div>
          </div>
        </div>
      </div>

      <div id="stats-review" class="row g-4 mb-4 d-none">
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('all')">
            <div class="stat-icon icon-gray">
              <i class="bi bi-folder2-open" style="font-size: 1.5rem;"></i>
            </div>
            <div class="stat-info"><span>有效命題總計(含命題中)</span>
              <h4 id="stat-total-review">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('採用')">
            <div class="stat-icon" style="background-color: #eff6ff;">
              <i class="bi bi-check-circle-fill text-primary" style="font-size: 1.5em;"></i>
            </div>
            <div class="stat-info"><span>採用</span>
              <h4 id="stat-adopted">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('改後再審')">
            <div class="stat-icon" style="background-color: #fff7ed;">
              <i class="bi bi-arrow-counterclockwise text-warning" style="font-size: 1.5em; font-weight: bold;"></i>
            </div>
            <div class="stat-info"><span>改後再審</span>
              <h4 id="stat-revise">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="stat-card interactive-card" onclick="filterByStatus('不採用')">
            <div class="stat-icon" style="background-color: #f3f4f6;">
              <i class="bi bi-x-circle-fill text-secondary" style="font-size: 1.5em;"></i>
            </div>
            <div class="stat-info"><span>不採用</span>
              <h4 id="stat-rejected">0</h4>
            </div>
          </div>
        </div>
      </div>

      <div class="card-box p-0 overflow-hidden">
        <div class="p-3 table-toolbar m-0">
          <div class="d-flex align-items-center gap-3">
            <div class="d-flex align-items-center gap-2">
              <span class="small fw-bold text-secondary text-nowrap">每頁顯示筆數</span>
              <select class="form-select form-select-sm">
                <option>10 筆</option>
                <option>20 筆</option>
              </select>
            </div>
          </div>

          <!-- 批次刪除按鈕，先註解取消 -->
          <div class="d-flex gap-2">
            <!-- <button class="btn-tool text-danger" onclick="batchAction('刪除')">
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="me-1">
                <path
                  d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" />
                <path
                  d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z" />
              </svg>
              <span>批次刪除</span>
            </button> -->

            <button class="btn-tool" onclick="resetSelection()">
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                </path>
              </svg>
              重置選擇
            </button>
            <button class="btn btn-primary d-flex align-items-center gap-2 shadow-sm"
              onclick="openPropModal(null, 'create')">
              <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
              </svg>
              <span class="fw-bold">新增試題</span>
            </button>
          </div>
        </div>

        <div class="px-3 pb-3">
          <table class="custom-table">
            <thead>
              <tr>
                <th style="width: 40px">
                  <input type="checkbox" class="form-check-input" />
                </th>
                <th style="width: 30%">題目內容摘要</th>
                <th>等級</th>
                <th>題型</th>
                <th>狀態</th>
                <th>建立時間</th>
                <th>最後修改時間</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr class="data-row" data-type="一般題目" data-status="命題草稿" data-level="初級"
                data-json='{"type":"一般題目","status":"命題草稿","time":"2026-01-29 14:45","level":"初級","mainCat":"語詞","subCat":"詞性分辨","difficulty":"易","propositioner":"沈雅茹","attachment":"","content":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(249%2C%20250%2C%20251)%3B%20color%3A%20rgb(33%2C%2037%2C%2041)%3B%22%3E%E9%97%9C%E6%96%BC%E4%BA%BA%E5%B7%A5%E6%99%BA%E6%85%A7%E5%9C%A8%E6%95%99%E8%82%B2%E6%87%89%E7%94%A8%E7%9A%84%E9%A1%8C%E7%9B%AE%EF%BC%81%3C%2Fspan%3E%3C%2Fp%3E","explanation":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(255%2C%20255%2C%20255)%3B%20color%3A%20rgb(51%2C%2051%2C%2051)%3B%22%3E%E7%9C%9F%E7%9A%84%E5%93%88%E5%93%88%E6%9C%89%E4%BB%80%E9%BA%BC%EF%BC%8C%E6%9C%89%E4%B9%9F%E5%A5%BD%EF%BC%8C%E8%A9%B1%E4%B8%8D%E7%9C%8B%E6%98%AF%E6%87%89%E8%A9%B2%E5%89%B5%E6%80%AA%E7%9A%84%E7%82%BA%E5%8D%A1%E7%89%87%EF%BC%8C%E9%9F%93%E5%9C%8B%E5%BE%88%E6%98%8E%E9%A1%AF%E8%87%AA%E5%BE%9E%EF%BC%8C%E7%8B%90%E8%83%BD%E5%88%87%E4%B8%80%E8%B5%B7%E8%AC%9D%E8%AC%9D%E5%9C%A8%E9%82%84%E6%B2%92%E6%88%91%E4%BA%86%EF%BC%8C%E6%B2%BB%E5%A5%BD%E8%8D%89%E5%9B%9E%E3%80%82%E8%B3%87%E6%96%99%E6%89%8B%E5%8F%88%E5%8F%AF%E4%BB%96%E4%B8%80%E9%80%8F%E6%98%8E%EF%BC%8C%E4%B8%8D%E8%AA%AA%E6%88%91%E6%9C%83%E7%9A%84%E7%9C%8B%EF%BC%8C%E4%BB%99%E4%B8%8D%E8%A9%B2%E6%88%91%E6%98%AF%E4%B8%8D%E5%89%9B%E5%89%9B%EF%BC%8C%E6%87%89%E8%A9%B2%E7%9A%84%E4%B8%80%E6%A8%A3%E4%B8%80%E9%96%8B%EF%BC%8C%E6%88%91%E9%83%BD%E9%80%99%E5%80%8B%E6%B3%A1%E9%BA%B5%E6%98%AF%E6%9C%83%E4%BA%86%E8%BA%AB%E4%B8%8A%E7%A2%8E%EF%BC%8C%E5%A5%BD%E5%B9%BE%E6%AC%A1%E6%98%AF%E6%83%B3%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E","summary":"關於人工智慧在教育應用的題目！","optA":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(255%2C%20255%2C%20255)%3B%20color%3A%20rgb(51%2C%2051%2C%2051)%3B%22%3E%E7%9C%9F%E7%9A%84%E5%93%88%E5%93%88%E6%9C%89%E4%BB%80%E9%BA%BC%EF%BC%8C%E6%9C%89%E4%B9%9F%E5%A5%BD%EF%BC%8C%E8%A9%B1%E4%B8%8D%E7%9C%8B%E6%98%AF%E6%87%89%E8%A9%B2%E5%89%B5%E6%80%AA%E7%9A%84%E7%82%BA%E5%8D%A1%E7%89%87%EF%BC%8C%E9%9F%93%E5%9C%8B%E5%BE%88%E6%98%8E%E9%A1%AF%E8%87%AA%E5%BE%9E%EF%BC%8C%E7%8B%90%E8%83%BD%E5%88%87%E4%B8%80%E8%B5%B7%E8%AC%9D%E8%AC%9D%E5%9C%A8%E9%82%84%E6%B2%92%E6%88%91%E4%BA%86%EF%BC%8C%E6%B2%BB%E5%A5%BD%E8%8D%89%E5%9B%9E%E3%80%82%E8%B3%87%E6%96%99%E6%89%8B%E5%8F%88%E5%8F%AF%E4%BB%96%E4%B8%80%E9%80%8F%E6%98%8E%EF%BC%8C%E4%B8%8D%E8%AA%AA%E6%88%91%E6%9C%83%E7%9A%84%E7%9C%8B%EF%BC%8C%E4%BB%99%E4%B8%8D%E8%A9%B2%E6%88%91%E6%98%AF%E4%B8%8D%E5%89%9B%E5%89%9B%EF%BC%8C%E6%87%89%E8%A9%B2%E7%9A%84%E4%B8%80%E6%A8%A3%E4%B8%80%E9%96%8B%EF%BC%8C%E6%88%91%E9%83%BD%E9%80%99%E5%80%8B%E6%B3%A1%E9%BA%B5%E6%98%AF%E6%9C%83%E4%BA%86%E8%BA%AB%E4%B8%8A%E7%A2%8E%EF%BC%8C%E5%A5%BD%E5%B9%BE%E6%AC%A1%E6%98%AF%E6%83%B3%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E","optB":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(255%2C%20255%2C%20255)%3B%20color%3A%20rgb(51%2C%2051%2C%2051)%3B%22%3E%E7%9C%9F%E7%9A%84%E5%93%88%E5%93%88%E6%9C%89%E4%BB%80%E9%BA%BC%EF%BC%8C%E6%9C%89%E4%B9%9F%E5%A5%BD%EF%BC%8C%E8%A9%B1%E4%B8%8D%E7%9C%8B%E6%98%AF%E6%87%89%E8%A9%B2%E5%89%B5%E6%80%AA%E7%9A%84%E7%82%BA%E5%8D%A1%E7%89%87%EF%BC%8C%E9%9F%93%E5%9C%8B%E5%BE%88%E6%98%8E%E9%A1%AF%E8%87%AA%E5%BE%9E%EF%BC%8C%E7%8B%90%E8%83%BD%E5%88%87%E4%B8%80%E8%B5%B7%E8%AC%9D%E8%AC%9D%E5%9C%A8%E9%82%84%E6%B2%92%E6%88%91%E4%BA%86%EF%BC%8C%E6%B2%BB%E5%A5%BD%E8%8D%89%E5%9B%9E%E3%80%82%E8%B3%87%E6%96%99%E6%89%8B%E5%8F%88%E5%8F%AF%E4%BB%96%E4%B8%80%E9%80%8F%E6%98%8E%EF%BC%8C%E4%B8%8D%E8%AA%AA%E6%88%91%E6%9C%83%E7%9A%84%E7%9C%8B%EF%BC%8C%E4%BB%99%E4%B8%8D%E8%A9%B2%E6%88%91%E6%98%AF%E4%B8%8D%E5%89%9B%E5%89%9B%EF%BC%8C%E6%87%89%E8%A9%B2%E7%9A%84%E4%B8%80%E6%A8%A3%E4%B8%80%E9%96%8B%EF%BC%8C%E6%88%91%E9%83%BD%E9%80%99%E5%80%8B%E6%B3%A1%E9%BA%B5%E6%98%AF%E6%9C%83%E4%BA%86%E8%BA%AB%E4%B8%8A%E7%A2%8E%EF%BC%8C%E5%A5%BD%E5%B9%BE%E6%AC%A1%E6%98%AF%E6%83%B3%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E","optC":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(255%2C%20255%2C%20255)%3B%20color%3A%20rgb(51%2C%2051%2C%2051)%3B%22%3E%E7%9C%9F%E7%9A%84%E5%93%88%E5%93%88%E6%9C%89%E4%BB%80%E9%BA%BC%EF%BC%8C%E6%9C%89%E4%B9%9F%E5%A5%BD%EF%BC%8C%E8%A9%B1%E4%B8%8D%E7%9C%8B%E6%98%AF%E6%87%89%E8%A9%B2%E5%89%B5%E6%80%AA%E7%9A%84%E7%82%BA%E5%8D%A1%E7%89%87%EF%BC%8C%E9%9F%93%E5%9C%8B%E5%BE%88%E6%98%8E%E9%A1%AF%E8%87%AA%E5%BE%9E%EF%BC%8C%E7%8B%90%E8%83%BD%E5%88%87%E4%B8%80%E8%B5%B7%E8%AC%9D%E8%AC%9D%E5%9C%A8%E9%82%84%E6%B2%92%E6%88%91%E4%BA%86%EF%BC%8C%E6%B2%BB%E5%A5%BD%E8%8D%89%E5%9B%9E%E3%80%82%E8%B3%87%E6%96%99%E6%89%8B%E5%8F%88%E5%8F%AF%E4%BB%96%E4%B8%80%E9%80%8F%E6%98%8E%EF%BC%8C%E4%B8%8D%E8%AA%AA%E6%88%91%E6%9C%83%E7%9A%84%E7%9C%8B%EF%BC%8C%E4%BB%99%E4%B8%8D%E8%A9%B2%E6%88%91%E6%98%AF%E4%B8%8D%E5%89%9B%E5%89%9B%EF%BC%8C%E6%87%89%E8%A9%B2%E7%9A%84%E4%B8%80%E6%A8%A3%E4%B8%80%E9%96%8B%EF%BC%8C%E6%88%91%E9%83%BD%E9%80%99%E5%80%8B%E6%B3%A1%E9%BA%B5%E6%98%AF%E6%9C%83%E4%BA%86%E8%BA%AB%E4%B8%8A%E7%A2%8E%EF%BC%8C%E5%A5%BD%E5%B9%BE%E6%AC%A1%E6%98%AF%E6%83%B3%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E","optD":"%3Cp%3E%3Cspan%20style%3D%22background-color%3A%20rgb(255%2C%20255%2C%20255)%3B%20color%3A%20rgb(51%2C%2051%2C%2051)%3B%22%3E%E7%9C%9F%E7%9A%84%E5%93%88%E5%93%88%E6%9C%89%E4%BB%80%E9%BA%BC%EF%BC%8C%E6%9C%89%E4%B9%9F%E5%A5%BD%EF%BC%8C%E8%A9%B1%E4%B8%8D%E7%9C%8B%E6%98%AF%E6%87%89%E8%A9%B2%E5%89%B5%E6%80%AA%E7%9A%84%E7%82%BA%E5%8D%A1%E7%89%87%EF%BC%8C%E9%9F%93%E5%9C%8B%E5%BE%88%E6%98%8E%E9%A1%AF%E8%87%AA%E5%BE%9E%EF%BC%8C%E7%8B%90%E8%83%BD%E5%88%87%E4%B8%80%E8%B5%B7%E8%AC%9D%E8%AC%9D%E5%9C%A8%E9%82%84%E6%B2%92%E6%88%91%E4%BA%86%EF%BC%8C%E6%B2%BB%E5%A5%BD%E8%8D%89%E5%9B%9E%E3%80%82%E8%B3%87%E6%96%99%E6%89%8B%E5%8F%88%E5%8F%AF%E4%BB%96%E4%B8%80%E9%80%8F%E6%98%8E%EF%BC%8C%E4%B8%8D%E8%AA%AA%E6%88%91%E6%9C%83%E7%9A%84%E7%9C%8B%EF%BC%8C%E4%BB%99%E4%B8%8D%E8%A9%B2%E6%88%91%E6%98%AF%E4%B8%8D%E5%89%9B%E5%89%9B%EF%BC%8C%E6%87%89%E8%A9%B2%E7%9A%84%E4%B8%80%E6%A8%A3%E4%B8%80%E9%96%8B%EF%BC%8C%E6%88%91%E9%83%BD%E9%80%99%E5%80%8B%E6%B3%A1%E9%BA%B5%E6%98%AF%E6%9C%83%E4%BA%86%E8%BA%AB%E4%B8%8A%E7%A2%8E%EF%BC%8C%E5%A5%BD%E5%B9%BE%E6%AC%A1%E6%98%AF%E6%83%B3%E3%80%82%3C%2Fspan%3E%3C%2Fp%3E","ans":"B"}'>
                <td><input type="checkbox" class="form-check-input"></td>
                <td class="text-dark fw-medium">關於人工智慧在教育應用的題目！</td>
                <td><span class="badge bg-light text-dark border">初級</span></td>
                <td>一般題目</td>
                <td><span class="badge-outline badge-draft">命題草稿</span></td>
                <td>2026-01-29 14:45</td>
                <td>2026-01-29 14:45</td>
                <td class="action-links"><button class="btn btn-link p-0 text-decoration-none fw-bold"
                    onclick="openPropModal(this, 'view')">檢視</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none fw-bold text-success"
                    onclick="openPropModal(this, 'edit')">編輯</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none fw-bold text-danger"
                    onclick="deleteRow(this)">刪除</button>
                </td>
              </tr>

              <tr class="data-row" data-type="一般題目" data-status="改後再審" data-level="中級"
                data-json='{"type":"一般題目","status":"改後再審","time":"2026-01-30 10:10","level":"中級","mainCat":"語詞","subCat":"詞性分辨","difficulty":"中","propositioner":"沈雅茹","attachment":"","content":"%3Cp%3E%E8%AB%8B%E4%BF%AE%E6%AD%A3%E9%A1%8C%E5%B9%B9%E6%95%98%E8%BF%B0%E5%BE%8C%E5%86%8D%E9%80%81%E5%AF%A9%E3%80%82%3C%2Fp%3E","explanation":"%3Cp%3E%E8%AB%8B%E6%8A%8A%E8%A9%B3%E7%B4%B0%E8%AA%AA%E6%98%8E%E8%A3%9C%E9%BD%8A%E3%80%82%3C%2Fp%3E","summary":"題幹需要調整的改後再審題目","optA":"%3Cp%3EA%3C%2Fp%3E","optB":"%3Cp%3EB%3C%2Fp%3E","optC":"%3Cp%3EC%3C%2Fp%3E","optD":"%3Cp%3ED%3C%2Fp%3E","ans":"B"}'>
                <td><input type="checkbox" class="form-check-input"></td>
                <td class="text-dark fw-medium">題幹需要調整的改後再審題目</td>
                <td><span class="badge bg-light text-dark border">中級</span></td>
                <td>一般題目</td>
                <td><span class="badge-outline badge-returned">改後再審</span></td>
                <td>2026-01-30 10:10</td>
                <td>2026-01-30 10:10</td>
                <td class="action-links"><button class="btn btn-link p-0 text-decoration-none fw-bold"
                    onclick="openPropModal(this, 'view')">檢視</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none fw-bold text-success"
                    onclick="openPropModal(this, 'edit')">編輯</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none fw-bold text-danger"
                    onclick="deleteRow(this)">刪除</button>
                </td>
              </tr>

              <tr class="data-row row-locked" data-type="精選題目" data-status="不採用" data-level="初級"
                data-json='{"level":"初級","mainCat":"修辭技巧","subCat":"修辭類型","content":"%3Cp%3E%E9%80%99%E6%98%AF%E4%B8%80%E7%AF%87%E7%AF%84%E4%BE%8B%E6%96%87%E7%AB%A0...%3C%2Fp%3E","subQuestions":[{"content":"%3Cp%3E%E5%AD%90%E9%A1%8C%E4%B8%80%E7%9A%84%E5%85%A7%E5%AE%B9%3C%2Fp%3E","optA":"%3Cp%3EA%3C%2Fp%3E","optB":"%3Cp%3EB%3C%2Fp%3E","optC":"%3Cp%3EC%3C%2Fp%3E","optD":"%3Cp%3ED%3C%2Fp%3E","ans":"A"}]}'>
                <td><input type="checkbox" class="form-check-input" disabled /></td>
                <td class="text-dark fw-medium">
                  退回後不採用的題目範例
                </td>
                <td><span class="badge bg-light text-dark border">初級</span></td>
                <td>精選題目</td>
                <td>
                  <span class="badge-outline badge-rejected">不採用</span>
                </td>
                <td>2026-01-22 13:20</td>
                <td>2026-01-22 13:20</td>
                <td class="action-links">
                  <button class="btn btn-link p-0 text-decoration-none small fw-bold"
                    onclick="openPropModal(this, 'view')">檢視</button>
                </td>
              </tr>

              <tr class="data-row" data-type="精選題目" data-status="命題完成" data-level="初級"
                data-json='{"level":"初級","mainCat":"修辭技巧","subCat":"修辭類型","content":"%3Cp%3E%E9%80%99%E6%98%AF%E4%B8%80%E7%AF%87%E7%AF%84%E4%BE%8B%E6%96%87%E7%AB%A0...%3C%2Fp%3E","subQuestions":[{"content":"%3Cp%3E%E5%AD%90%E9%A1%8C%E4%B8%80%E7%9A%84%E5%85%A7%E5%AE%B9%3C%2Fp%3E","optA":"%3Cp%3EA%3C%2Fp%3E","optB":"%3Cp%3EB%3C%2Fp%3E","optC":"%3Cp%3EC%3C%2Fp%3E","optD":"%3Cp%3ED%3C%2Fp%3E","ans":"A"}]}'>
                <td><input type="checkbox" class="form-check-input" /></td>
                <td class="text-dark fw-medium">
                  下列哪個選項修辭技巧使用正確？
                </td>
                <td><span class="badge bg-light text-dark border">初級</span></td>
                <td>精選題目</td>
                <td>
                  <span class="badge-outline badge-confirmed">命題完成</span>
                </td>
                <td>2024-05-18 09:00</td>
                <td>2024-05-19 11:20</td>
                <td class="action-links">
                  <button class="btn btn-link p-0 text-decoration-none small fw-bold"
                    onclick="openPropModal(this, 'view')">檢視</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none small fw-bold text-success"
                    onclick="openPropModal(this, 'edit')">編輯</button>
                  <span class="text-muted mx-1">|</span>
                  <button class="btn btn-link p-0 text-decoration-none small fw-bold text-danger"
                    onclick="deleteRow(this)">刪除</button>
                </td>
              </tr>

              <tr class="data-row row-locked" data-type="閱讀題組" data-status="命題送審" data-level="中高級"
                data-json='{"level":"中高級","mainCat":"語體文","content":"%3Cp%3E%E9%80%99%E6%98%AF%E4%B8%80%E7%AF%87%E7%AF%84%E4%BE%8B%E6%96%87%E7%AB%A0...%3C%2Fp%3E","subQuestions":[{"content":"%3Cp%3E%E5%AD%90%E9%A1%8C%E4%B8%80%E7%9A%84%E5%85%A7%E5%AE%B9%3C%2Fp%3E","optA":"%3Cp%3EA%3C%2Fp%3E","optB":"%3Cp%3EB%3C%2Fp%3E","optC":"%3Cp%3EC%3C%2Fp%3E","optD":"%3Cp%3ED%3C%2Fp%3E","ans":"A"}]}'>
                <td><input type="checkbox" class="form-check-input" disabled /></td>
                <td class="text-dark fw-medium">
                  [閱讀] 閱讀下文，回答問題 3-5... (1子題)
                </td>
                <td><span class="badge bg-light text-dark border">中高級</span></td>
                <td>閱讀題組</td>
                <td><span class="badge-outline badge-sent">命題送審</span></td>
                <td>2024-05-15 16:45</td>
                <td>2024-05-16 10:00</td>
                <td class="action-links">
                  <button class="btn btn-link p-0 text-decoration-none small fw-bold"
                    onclick="openPropModal(this, 'view')">檢視</button>
                </td>
              </tr>

              <tr id="noDataRow" style="display: none">
                <td colspan="7" class="text-center py-5 text-secondary">
                  <div class="d-flex flex-column align-items-center opacity-50">
                    <h6 class="fw-bold mt-2">沒有符合的試題</h6>
                    <p class="small">請嘗試調整搜尋條件</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="pagination-container">
            <span class="page-info">第 1 頁 / 共 2 頁</span>
            <a href="#" class="page-btn disabled">&lt;</a>
            <a href="#" class="page-btn active">1</a>
            <a href="#" class="page-btn">2</a>
            <a href="#" class="page-btn">&gt;</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- 表單區塊 -->
  <div class="modal fade" id="propModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static"
    data-bs-focus="false">
    <div class="modal-dialog modal-fullscreen modal-dialog-centered p-3">
      <div class="modal-content border-0 rounded-4 shadow">

        <div class="modal-header border-bottom-0">
          <h5 class="modal-title fw-bold" id="propModalTitle">編輯命題</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body pt-0">
          <form id="propForm">
            <input type="hidden" id="editRowFrom" value="">

            <div class="row g-2 top-section mb-3">
              <div class="col-md-2">
                <label class="form-label fw-bold small text-secondary mb-1">題型選擇</label>
                <select class="form-select form-select-sm" id="mType">
                  <option value="一般題目" selected>一般題目</option>
                  <option value="長文題目">長文題目</option>
                  <option value="短文題組">短文題組</option>
                  <option value="精選題目">精選題目</option>
                  <option value="閱讀題組">閱讀題組</option>
                  <option value="聽力題目">聽力題目</option>
                  <option value="聽力題組">聽力題組</option>
                </select>
              </div>

              <div class="col-md-2">
                <label class="form-label fw-bold small text-secondary mb-1 required-star"
                  id="lblCommonLevel">適用等級</label>
                <select class="form-select form-select-sm" id="commonLevel">
                  <option value="">請選擇...</option>
                  <option value="初級">初級</option>
                  <option value="中級">中級</option>
                  <option value="中高級">中高級</option>
                  <option value="高級">高級</option>
                  <option value="優級">優級</option>
                </select>
              </div>

              <div class="col-md-2">
                <label class="form-label fw-bold small text-secondary mb-1">命題者</label>
                <input type="text" class="form-control form-control-sm readonly-field" id="commonPropositioner"
                  value="沈雅茹" disabled readonly>
              </div>

              <div class="col-md-3">
                <label class="form-label fw-bold small text-secondary mb-1">最後修訂日</label>
                <input type="text" class="form-control form-control-sm readonly-field" id="commonLastModified" value="-"
                  disabled readonly>
              </div>

              <div class="col-md-3">
                <label class="form-label fw-bold small text-secondary mb-1">目前狀態</label>
                <div class="d-flex align-items-center">
                  <span class="badge-outline badge-draft" id="mStatusBadge">命題草稿</span>
                </div>
              </div>
            </div>


            <!-- 一般題目 -->
            <!-- 精選題目 -->
            <div id="form-general" class="question-form-group prop-grid-layout">

              <div class="row g-0 border rounded-3 overflow-hidden shadow-sm">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">主類</label>
                    <select class="form-select" id="gMainCategory">
                      <option value="">請選擇...</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">次類</label>
                    <select class="form-select readonly-field" id="gSubCategory" disabled>
                      <option value="">請先選擇主類</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large">難度</label>
                    <div class="btn-group w-100" role="group">
                      <input type="radio" class="btn-check" name="gDifficultyRadio" id="gDiff1" value="易"
                        onclick="syncDifficulty('易')">
                      <label class="btn btn-outline-secondary" for="gDiff1">易</label>

                      <input type="radio" class="btn-check" name="gDifficultyRadio" id="gDiff2" value="中"
                        onclick="syncDifficulty('中')" checked>
                      <label class="btn btn-outline-secondary" for="gDiff2">中</label>

                      <input type="radio" class="btn-check" name="gDifficultyRadio" id="gDiff3" value="難"
                        onclick="syncDifficulty('難')">
                      <label class="btn btn-outline-secondary" for="gDiff3">難</label>
                    </div>
                    <select id="gDifficulty" class="d-none">
                      <option value="易">易</option>
                      <option value="中" selected>中</option>
                      <option value="難">難</option>
                    </select>
                  </div>

                  <hr class="my-2">

                  <div class="sidebar-item">
                    <label class="prop-label-large text-success">正確答案</label>
                    <select class="form-select form-select-lg border-success text-success fw-bold" id="gCorrectAnswer"
                      style="background-color: #f0fdf4;">
                      <option value="">尚未選擇</option>
                      <option value="A">選項 A</option>
                      <option value="B">選項 B</option>
                      <option value="C">選項 C</option>
                      <option value="D">選項 D</option>
                    </select>
                    <div class="form-text small mt-2">
                      <i class="bi bi-info-circle me-1"></i> 選擇後右側選項框將顯示綠色邊框
                    </div>
                  </div>
                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-2 required-star">題目</h6>
                    <div class="editor-preview-box border rounded-top-3 p-3" id="preview-g-content"
                      data-field="g-content" data-placeholder="點擊輸入題幹..." onclick="openCommonEditor(this)"></div>
                    <input type="hidden" id="hidden-g-content" name="g-content">

                    <div class="attachment-wrapper p-2 border rounded bg-light d-flex align-items-center gap-2">
                      <label class="small fw-bold text-muted text-nowrap">附檔 (圖片)</label>
                      <input class="form-control form-control-sm" type="file" id="file-g-content">
                    </div>
                  </div>

                  <hr class="border-secondary opacity-10">

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-3 required-star">選項與正確答案
                    </h6>
                    <div class="alert-hint">
                      <i class="bi bi-exclamation-circle-fill"></i>
                      請避免選項長短、語氣明顯差異，以免影響鑑別度
                    </div>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="optionCardA">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 A</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-g-optA" data-field="g-optA"
                            data-placeholder="點擊輸入選項 A..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-g-optA">
                          <div class="card-footer p-1 bg-white border-top"><input
                              class="form-control form-control-sm border-0" type="file" id="file-g-optA"></div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="optionCardB">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 B</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-g-optB" data-field="g-optB"
                            data-placeholder="點擊輸入選項 B..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-g-optB">
                          <div class="card-footer p-1 bg-white border-top"><input
                              class="form-control form-control-sm border-0" type="file" id="file-g-optB"></div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="optionCardC">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 C</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-g-optC" data-field="g-optC"
                            data-placeholder="點擊輸入選項 C..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-g-optC">
                          <div class="card-footer p-1 bg-white border-top"><input
                              class="form-control form-control-sm border-0" type="file" id="file-g-optC"></div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="optionCardD">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 D</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-g-optD" data-field="g-optD"
                            data-placeholder="點擊輸入選項 D..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-g-optD">
                          <div class="card-footer p-1 bg-white border-top"><input
                              class="form-control form-control-sm border-0" type="file" id="file-g-optD"></div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <hr class="border-secondary opacity-10">

                  <div class="mb-2">
                    <h6 class="fw-bold text-dark border-start border-4 border-secondary ps-2 mb-2">試題解析 (紀錄答案理由)</h6>
                    <div class="editor-preview-box border rounded-3 p-3" id="preview-g-explanation"
                      data-field="g-explanation" data-placeholder="請簡要說明正確答案的判斷依據，並簡述其他選項錯誤原因..."
                      onclick="openCommonEditor(this)"></div>
                    <input type="hidden" id="hidden-g-explanation" name="g-explanation">
                  </div>
                </div>
              </div>
            </div>
            <!-- 長文題目 -->
            <div id="form-longarticle" class="question-form-group prop-grid-layout d-none">

              <div class="row g-0 border rounded-3 overflow-hidden shadow-sm">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">題型</label>
                    <select class="form-select" id="lType">
                      <option value="">請選擇...</option>
                      <option value="引導寫作">引導寫作</option>
                      <option value="資訊整合">資訊整合</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large">難度</label>
                    <div class="btn-group w-100" role="group">
                      <input type="radio" class="btn-check" name="lDifficultyRadio" id="lDiff1" value="易"
                        onclick="syncDifficultyL('易')">
                      <label class="btn btn-outline-secondary" for="lDiff1">易</label>

                      <input type="radio" class="btn-check" name="lDifficultyRadio" id="lDiff2" value="中"
                        onclick="syncDifficultyL('中')" checked>
                      <label class="btn btn-outline-secondary" for="lDiff2">中</label>

                      <input type="radio" class="btn-check" name="lDifficultyRadio" id="lDiff3" value="難"
                        onclick="syncDifficultyL('難')">
                      <label class="btn btn-outline-secondary" for="lDiff3">難</label>
                    </div>
                    <select id="lDifficulty" class="d-none">
                      <option value="易">易</option>
                      <option value="中" selected>中</option>
                      <option value="難">難</option>
                    </select>
                  </div>

                  <div class="mt-auto">
                    <div class="alert alert-light border small text-muted">
                      <i class="bi bi-info-circle-fill me-1"></i>
                      長文題目請務必填寫標題與文章內容，若有圖片請使用附檔上傳。
                    </div>
                  </div>
                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-secondary ps-2 mb-2">題目 (可略)</h6>
                    <div class="editor-preview-box border rounded-3 p-3" id="preview-lTopic" data-field="lTopic"
                      data-placeholder="點擊輸入長文題幹..." onclick="openCommonEditor(this)"></div>
                    <input type="hidden" id="hidden-lTopic">
                  </div>

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-2 required-star">文章內容</h6>
                    <div class="editor-preview-box border rounded-top-3 p-3" id="preview-l-content"
                      data-field="l-content" data-placeholder="點擊輸入文章內容..." onclick="openCommonEditor(this)"></div>
                    <input type="hidden" id="hidden-l-content" name="l-content">

                    <div class="attachment-wrapper p-2 border rounded bg-light d-flex align-items-center gap-2">
                      <label class="small fw-bold text-muted text-nowrap">附檔 (圖片)</label>
                      <input class="form-control form-control-sm" type="file" id="lAttachment">
                    </div>
                  </div>

                  <hr class="border-secondary opacity-10">

                  <div class="mb-2">
                    <h6 class="fw-bold text-dark border-start border-4 border-secondary ps-2 mb-2">試題解析 (紀錄答案理由)</h6>
                    <div class="editor-preview-box border rounded-3 p-3" id="preview-l-explanation"
                      data-field="l-explanation" data-placeholder="請簡要說明長文題目的解析..." onclick="openCommonEditor(this)">
                    </div>
                    <input type="hidden" id="hidden-l-explanation" name="l-explanation">
                  </div>

                </div>
              </div>
            </div>
            <!-- 短文題組 -->
            <div id="form-shortarticle" class="question-form-group prop-grid-layout d-none">
              <div class="row g-0 border rounded-3 overflow-hidden shadow-sm">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large">主類 / 次類</label>
                    <input type="text" class="form-control readonly-field" value="文義判讀 / 篇章辨析" readonly disabled>
                    <div class="form-text small mt-2 text-muted">
                      <i class="bi bi-info-circle me-1"></i>僅有一項，故固定為此。
                    </div>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">文體</label>
                    <select class="form-select" id="sGenre">
                      <option value="">請選擇...</option>
                      <option value="文言文">文言文</option>
                      <option value="應用文">應用文</option>
                      <option value="語體文">語體文</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large">難度</label>
                    <div class="btn-group w-100" role="group">
                      <input type="radio" class="btn-check" name="sDifficultyRadio" id="sDiff1" value="易"
                        onclick="syncDifficultyS('易')">
                      <label class="btn btn-outline-secondary" for="sDiff1">易</label>

                      <input type="radio" class="btn-check" name="sDifficultyRadio" id="sDiff2" value="中"
                        onclick="syncDifficultyS('中')" checked>
                      <label class="btn btn-outline-secondary" for="sDiff2">中</label>

                      <input type="radio" class="btn-check" name="sDifficultyRadio" id="sDiff3" value="難"
                        onclick="syncDifficultyS('難')">
                      <label class="btn btn-outline-secondary" for="sDiff3">難</label>
                    </div>
                    <select id="sDifficulty" class="d-none">
                      <option value="易">易</option>
                      <option value="中" selected>中</option>
                      <option value="難">難</option>
                    </select>
                  </div>

                  <div class="mt-auto">
                    <div class="alert alert-light border small text-muted">
                      <i class="bi bi-info-circle-fill me-1"></i>
                      短文題組請先填寫右側母題文章，再新增子題。
                    </div>
                  </div>
                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div>
                    <h5 class="fw-bold text-dark border-bottom pb-2 mb-3">
                      <i class="bi bi-journal-text me-2 text-primary"></i>母題
                    </h5>

                    <div class="mb-3">
                      <h6 class="fw-bold border-start border-4 border-primary text-secondary ps-2 mb-2 required-star">題目
                      </h6>
                      <div class="editor-preview-box article-preview-box border rounded-3 p-3" id="preview-sTopic"
                        data-field="sTopic" data-placeholder="點擊輸入母題標題..." onclick="openCommonEditor(this)"></div>
                      <input type="hidden" id="hidden-sTopic" name="sTopic">
                    </div>

                    <div class="mb-3">
                      <h6 class="fw-bold border-start border-4 border-primary text-secondary ps-2 mb-2 required-star">
                        文章內容</h6>
                      <div class="editor-preview-box border rounded-top-3 p-3" id="preview-s-article"
                        data-field="s-article" data-placeholder="點擊輸入短文內容..." onclick="openCommonEditor(this)"></div>
                      <input type="hidden" id="hidden-s-article" name="s-article">

                      <div class="attachment-wrapper p-2 border rounded bg-light d-flex align-items-center gap-2">
                        <label class="small fw-bold text-muted text-nowrap">附檔 (圖片)</label>
                        <input class="form-control form-control-sm" type="file" id="file-s-article">
                      </div>
                    </div>
                  </div>

                  <div class="sub-question-container bg-light border rounded-3 p-3">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h5 class="fw-bold text-dark m-0">
                        <i class="bi bi-list-ol me-2 text-primary"></i>子題列表
                      </h5>
                      <button type="button" class="btn btn-primary btn-sm shadow-sm" id="btn-add-s-sub">
                        <i class="bi bi-plus-lg me-1"></i>新增子題
                      </button>
                    </div>

                    <div id="s-sub-questions-container">
                    </div>

                    <div id="short-sub-empty" class="text-center py-5 text-muted border border-dashed rounded bg-white">
                      <div class="opacity-50 mb-2">
                        <i class="bi bi-clipboard-plus" style="font-size: 2rem;"></i>
                      </div>
                      <p class="mb-0">尚未新增任何子題</p>
                      <small>請點擊右上方按鈕新增</small>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <!-- 閱讀題組 -->
            <div id="form-reading" class="question-form-group prop-grid-layout d-none">
              <div class="row g-0 border rounded-3 shadow-sm">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">文體</label>
                    <select class="form-select" id="rGenre">
                      <option value="">請選擇...</option>
                      <option value="文言文">文言文</option>
                      <option value="應用文">應用文</option>
                      <option value="語體文">語體文</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large">難度</label>
                    <div class="btn-group w-100" role="group">
                      <input type="radio" class="btn-check" name="rDifficultyRadio" id="rDiff1" value="易"
                        onclick="syncDifficultyR('易')">
                      <label class="btn btn-outline-secondary" for="rDiff1">易</label>

                      <input type="radio" class="btn-check" name="rDifficultyRadio" id="rDiff2" value="中"
                        onclick="syncDifficultyR('中')" checked>
                      <label class="btn btn-outline-secondary" for="rDiff2">中</label>

                      <input type="radio" class="btn-check" name="rDifficultyRadio" id="rDiff3" value="難"
                        onclick="syncDifficultyR('難')">
                      <label class="btn btn-outline-secondary" for="rDiff3">難</label>
                    </div>
                    <select id="rDifficulty" class="d-none">
                      <option value="易">易</option>
                      <option value="中" selected>中</option>
                      <option value="難">難</option>
                    </select>
                  </div>

                  <hr class="my-2">

                  <div class="sidebar-item">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <label class="prop-label-large text-success mb-0">正確答案</label>
                      <span class="badge bg-primary-subtle text-primary border border-primary-subtle"
                        id="rSidebarSubLabel" style="display:none;">
                        <i class="bi bi-pencil-fill me-1"></i><span id="rSidebarSubText">子題代碼：1</span>
                      </span>
                    </div>

                    <select class="form-select form-select-lg border-success text-success fw-bold" id="rSidebarAnswer"
                      style="background-color: #f0fdf4;" disabled>
                      <option value="">尚未選擇</option>
                      <option value="A">選項 A</option>
                      <option value="B">選項 B</option>
                      <option value="C">選項 C</option>
                      <option value="D">選項 D</option>
                    </select>
                    <div class="form-text small mt-2">
                      <i class="bi bi-info-circle me-1"></i> 選取後將同步至右側展開的子題
                    </div>
                  </div>

                  <div class="mt-auto">
                    <div class="alert alert-light border small text-muted">
                      <i class="bi bi-info-circle-fill me-1"></i>
                      點擊右側子題展開後，即可在左側設定該題答案。
                    </div>
                  </div>
                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div class="mb-4">
                    <h5 class="fw-bold text-dark border-bottom pb-2 mb-3">
                      <i class="bi bi-book me-2 text-primary"></i>母題
                    </h5>

                    <div class="mb-3">
                      <label class="form-label fw-bold small text-secondary required-star">母題標題</label>
                      <div class="editor-preview-box article-preview-box border rounded-3 p-3" id="preview-rTopic"
                        data-field="rTopic" data-placeholder="點擊輸入母題標題..." onclick="openCommonEditor(this)"></div>
                      <input type="hidden" id="hidden-rTopic" name="rTopic">
                    </div>

                    <div class="mb-3">
                      <label class="form-label fw-bold small text-secondary required-star">母題內容</label>
                      <div class="editor-preview-box border rounded-top-3 p-3" id="preview-rArticle"
                        data-field="rArticle" data-placeholder="點擊輸入母題內容..." onclick="openCommonEditor(this)"></div>
                      <input type="hidden" id="hidden-rArticle" name="rArticle">

                      <div class="attachment-wrapper p-2 border rounded bg-light d-flex align-items-center gap-2">
                        <label class="small fw-bold text-muted text-nowrap">附檔 (圖片)</label>
                        <input class="form-control form-control-sm" type="file" id="file-rArticle">
                      </div>
                    </div>
                  </div>

                  <div class="sub-question-container bg-light border rounded-3 p-3">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h5 class="fw-bold text-dark m-0">
                        <i class="bi bi-list-ol me-2 text-primary"></i>子題列表
                      </h5>
                      <button type="button" class="btn btn-primary btn-sm shadow-sm" id="btn-add-reading-sub">
                        <i class="bi bi-plus-lg me-1"></i>新增子題
                      </button>
                    </div>

                    <div id="reading-sub-container">
                    </div>

                    <div id="reading-sub-empty"
                      class="text-center py-5 text-muted border border-dashed rounded bg-white">
                      <div class="opacity-50 mb-2">
                        <i class="bi bi-clipboard-plus" style="font-size: 2rem;"></i>
                      </div>
                      <p class="mb-0">尚未新增任何子題</p>
                      <small>請點擊右上方按鈕新增</small>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <!-- 聽力題目 -->
            <div id="form-listen" class="question-form-group prop-grid-layout d-none">

              <div class="row g-0 border rounded-3 overflow-hidden shadow-sm">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large">核心能力 / 細目指標</label>
                    <input type="text" class="form-control readonly-field text-truncate" id="liCoreIndicatorDisplay"
                      readonly disabled value="請先選擇難度" title="">
                    <input type="hidden" id="liCore">
                    <input type="hidden" id="liIndicator">
                    <div class="form-text small mt-2 text-muted">
                      <i class="bi bi-info-circle me-1"></i>僅有一項，故依據難度自動帶入。
                    </div>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">語音類型</label>
                    <select class="form-select" id="liVoiceType">
                      <option value="">請選擇...</option>
                      <option value="對話">對話</option>
                      <option value="情境">情境</option>
                      <option value="陳述">陳述</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">素材分類</label>
                    <select class="form-select" id="liMaterial">
                      <option value="">請選擇...</option>
                      <option value="生活">生活</option>
                      <option value="教育">教育</option>
                      <option value="職場">職場</option>
                      <option value="專業">專業</option>
                    </select>
                  </div>

                  <hr class="my-2">

                  <div class="sidebar-item">
                    <label class="prop-label-large text-success required-star">正確答案</label>
                    <select class="form-select form-select-lg border-success text-success fw-bold" id="liCorrectAnswer"
                      style="background-color: #f0fdf4;">
                      <option value="">尚未選擇</option>
                      <option value="A">選項 A</option>
                      <option value="B">選項 B</option>
                      <option value="C">選項 C</option>
                      <option value="D">選項 D</option>
                    </select>
                    <div class="form-text small mt-2">
                      <i class="bi bi-info-circle me-1"></i> 選擇後右側選項框將顯示綠色邊框
                    </div>
                  </div>

                  <input type="hidden" id="liPropositioner" value="沈雅茹">
                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-2 required-star">題目</h6>
                    <div class="editor-preview-box border rounded-3 p-3" id="preview-liTopic" data-field="liTopic"
                      data-placeholder="點擊輸入題幹..." onclick="openCommonEditor(this)"></div>
                    <input type="hidden" id="hidden-liTopic">
                  </div>

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-2 required-star">語音內容</h6>
                    <div class="editor-preview-box border rounded-top-3 p-3" id="preview-listen-content"
                      data-field="listen-content" data-placeholder="點擊輸入語音內容腳本..." onclick="openCommonEditor(this)">
                    </div>
                    <input type="hidden" id="hidden-listen-content" name="listen-content">

                    <div
                      class="attachment-wrapper p-2 border rounded-bottom bg-light d-flex align-items-center gap-2 border-top-0">
                      <label class="small fw-bold text-primary text-nowrap"><i
                          class="bi bi-volume-up-fill me-1"></i>題目音檔 (MP3)</label>
                      <input class="form-control form-control-sm" type="file" id="liAttachment" accept="audio/*">
                    </div>
                    <div class="form-text small mt-1 text-primary d-none" id="liAttachmentName"></div>
                  </div>

                  <hr class="border-secondary opacity-10">

                  <div class="mb-4">
                    <h6 class="fw-bold text-dark border-start border-4 border-primary ps-2 mb-3 required-star">選項設定</h6>
                    <div class="alert-hint">
                      <i class="bi bi-exclamation-circle-fill"></i>
                      聽力選項通常為圖片或短語，請盡量保持長度一致。
                    </div>

                    <div class="row g-3">
                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="liOptionCardA">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 A</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-listen-optA"
                            data-field="listen-optA" data-placeholder="點擊輸入選項 A..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-listen-optA">
                          <div class="card-footer p-1 bg-white border-top">
                            <input class="form-control form-control-sm border-0" type="file" id="file-listen-optA">
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="liOptionCardB">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 B</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-listen-optB"
                            data-field="listen-optB" data-placeholder="點擊輸入選項 B..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-listen-optB">
                          <div class="card-footer p-1 bg-white border-top">
                            <input class="form-control form-control-sm border-0" type="file" id="file-listen-optB">
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="liOptionCardC">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 C</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-listen-optC"
                            data-field="listen-optC" data-placeholder="點擊輸入選項 C..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-listen-optC">
                          <div class="card-footer p-1 bg-white border-top">
                            <input class="form-control form-control-sm border-0" type="file" id="file-listen-optC">
                          </div>
                        </div>
                      </div>

                      <div class="col-md-6">
                        <div class="card option-card h-100 shadow-sm" id="liOptionCardD">
                          <div
                            class="card-header py-1 px-2 bg-light border-bottom text-muted small fw-bold d-flex justify-content-between">
                            <span>選項 D</span><i class="bi bi-check-circle-fill text-success correct-mark d-none"></i>
                          </div>
                          <div class="editor-preview-box p-3 border-0 h-100" id="preview-listen-optD"
                            data-field="listen-optD" data-placeholder="點擊輸入選項 D..." onclick="openCommonEditor(this)">
                          </div>
                          <input type="hidden" id="hidden-listen-optD">
                          <div class="card-footer p-1 bg-white border-top">
                            <input class="form-control form-control-sm border-0" type="file" id="file-listen-optD">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <hr class="border-secondary opacity-10">

                  <div class="mb-2">
                    <h6 class="fw-bold text-dark border-start border-4 border-secondary ps-2 mb-2">試題解析 (紀錄答案理由)</h6>
                    <div class="editor-preview-box border rounded-3 p-3 bg-white" id="preview-listen-explanation"
                      data-field="listen-explanation" data-placeholder="請簡要說明正確答案的判斷依據，並簡述其他選項錯誤原因..."
                      onclick="openCommonEditor(this)">
                    </div>
                    <input type="hidden" id="hidden-listen-explanation" name="listen-explanation">
                  </div>

                </div>
              </div>
            </div>
            <!-- 聽力題組 -->
            <div id="form-listengroup" class="question-form-group prop-grid-layout d-none">
              <div class="row g-0 border rounded-3 overflow-hidden shadow-sm h-100">

                <div class="col-md-3 bg-light border-end p-4 d-flex flex-column gap-3 sidebar-panel">

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">語音類型</label>
                    <select class="form-select" id="lgVoiceType">
                      <option value="">請選擇...</option>
                      <option value="對話">對話</option>
                      <option value="情境">情境</option>
                      <option value="陳述">陳述</option>
                    </select>
                  </div>

                  <div class="sidebar-item">
                    <label class="prop-label-large required-star">素材分類</label>
                    <select class="form-select" id="lgMaterial">
                      <option value="">請選擇...</option>
                      <option value="生活">生活</option>
                      <option value="教育">教育</option>
                      <option value="職場">職場</option>
                      <option value="專業">專業</option>
                    </select>
                  </div>

                  <hr class="my-2">

                  <div class="sidebar-item">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                      <label class="prop-label-large text-success mb-0">正確答案</label>
                      <span class="badge bg-primary-subtle text-primary border border-primary-subtle"
                        id="lgSidebarSubLabel" style="display:none;">
                        <i class="bi bi-pencil-fill me-1"></i><span id="lgSidebarSubText">子題代碼：1</span>
                      </span>
                    </div>

                    <select class="form-select form-select-lg border-success text-success fw-bold" id="lgSidebarAnswer"
                      style="background-color: #f0fdf4;" disabled>
                      <option value="">尚未選擇</option>
                      <option value="A">A</option>
                      <option value="B">B</option>
                      <option value="C">C</option>
                      <option value="D">D</option>
                    </select>
                    <div class="form-text mt-2 text-muted small">
                      <i class="bi bi-info-circle me-1"></i>選取後將同步至右側展開的子題
                    </div>
                  </div>

                  <div class="mt-auto">
                    <div class="alert alert-light border small text-muted">
                      <i class="bi bi-info-circle-fill me-1"></i>
                      本題組包含兩小題，屬性已固定：
                      <ul class="mb-0 ps-3 mt-1">
                        <li>第1題：難度三 / 推斷訊息</li>
                        <li>第2題：難度四 / 歸納分析</li>
                      </ul>
                    </div>
                  </div>

                </div>

                <div class="col-md-9 bg-white p-4 main-panel">

                  <div class="mb-4">
                    <h5 class="fw-bold text-dark border-bottom pb-2 mb-3">
                      <i class="bi bi-soundwave me-2 text-primary"></i>母題
                    </h5>

                    <div class="mb-3">
                      <label class="form-label fw-bold small text-secondary required-star">語音內容</label>
                      <div class="editor-preview-box border rounded-top-3 p-3" id="preview-lg-content"
                        data-field="lg-content" data-placeholder="點擊輸入語音內容..." onclick="openCommonEditor(this)"></div>
                      <input type="hidden" id="hidden-lg-content" name="lg-content">
                      <div
                        class="attachment-wrapper p-2 border rounded-bottom bg-light d-flex align-items-center gap-2 border-top-0">
                        <label class="small fw-bold text-primary text-nowrap"><i
                            class="bi bi-volume-up-fill me-1"></i>母題音檔</label>
                        <input class="form-control form-control-sm" type="file" id="lgAttachment">
                      </div>
                      <div class="form-text small mt-1 text-primary d-none" id="lgAttachmentName"></div>
                    </div>
                  </div>

                  <div class="mb-4">
                    <div class="sub-question-container bg-light border rounded-3 p-3">
                      <h5 class="fw-bold text-dark border-bottom pb-2 mb-3">
                        <i class="bi bi-list-ol me-2 text-primary"></i>子題列表
                      </h5>
                      <div id="listengroup-sub-container"></div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-light" data-bs-dismiss="modal">取消</button>
          <button type="button" class="btn btn-outline-primary" id="btnSaveDraft"
            onclick="saveProp('命題草稿')">存為草稿</button>
          <button type="button" class="btn btn-primary fw-bold" id="btnSaveConfirm"
            onclick="saveProp('命題完成')">儲存並確認</button>
        </div>
      </div>
    </div>
  </div>
  <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1060;">
    <div id="liveToast" class="toast align-items-center text-white border-0" role="alert" aria-live="assertive"
      aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
          aria-label="Close"></button>
      </div>
    </div>
  </div>
  <!-- 共用編輯器 -->
  <div id="common-editor-backdrop"
    style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 1999; display: none; opacity: 0; transition: opacity 0.3s ease;">
  </div>

  <div id="common-editor-wrapper" class="fixed-bottom bg-white shadow-lg border-top"
    style="display: none; z-index: 2000;">
    <div class="container-fluid p-0">
      <div class="punctuation-toolbar d-flex flex-wrap gap-1 p-2 bg-light border-bottom">
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="，">，</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="。">。</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="、">、</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="？">？</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="！">！</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="：">：</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="；">；</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="「」" data-back="1">「」</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="『』" data-back="1">『』</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="（）" data-back="1">（）</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="【】" data-back="1">【】</button>
        <button type="button" class="btn btn-sm btn-outline-secondary punc-btn" data-char="……">……</button>
      </div>

      <div id="common-quill-editor" style="height: 100px;"></div>

      <div class="d-flex justify-content-between align-items-center p-2 bg-light border-top">
        <div class="small text-secondary ps-2">
          字數：<span id="common-word-count">0</span>
        </div>
        <button type="button" class="btn btn-primary btn-sm px-4" onclick="CommonEditorManager.close()">完成</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/sweetalert2.min.js"></script>
  <script src="js/quill.min.js"></script>
  <script src="js/cwt-list.js"></script>
</body>

</html>