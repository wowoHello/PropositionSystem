<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>審題清單 - CWT 命題工作平臺</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/modal-enhanced.css">
    <link rel="stylesheet" href="css/review-fix.css">
    <link rel="stylesheet" href="css/quill.snow.css">
    <link rel="stylesheet" href="css/sweetalert2.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&display=swap"
        rel="stylesheet" />
    <style>
        /* === 頁面專用樣式 === */
        :root {
            --primary-blue: #2563eb;
            --bg-color: #f0f2f5;
            --text-dark: #1f2937;
            --text-gray: #6b7280;
            /* 審題狀態顏色 */
            --review-mutual: #8b5cf6;
            /* 互審 - 紫色 */
            --review-expert: #f59e0b;
            /* 專審 - 橙色 */
            --review-final: #ef4444;
            /* 總審 - 紅色 */
        }

        /* 自訂紫色背景 (Bootstrap 沒有內建) */
        .bg-purple {
            background-color: #8b5cf6 !important;
        }

        body {
            font-family: "Noto Sans TC", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* 主要內容區 */
        .main-content {
            padding: 2rem 0;
            flex-grow: 1;
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 0.25rem;
        }

        .page-desc {
            color: var(--text-gray);
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
        }

        /* 通用卡片樣式 */
        .card-box {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* 搜尋區 */
        .search-area .form-label {
            font-size: 0.85rem;
            font-weight: 700;
            color: #374151;
            margin-bottom: 0.4rem;
        }

        .search-area .form-select,
        .search-area .form-control {
            background-color: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 0.6rem 1rem;
            font-size: 0.95rem;
        }

        /* 統計卡片區 */
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            height: 100%;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
        }

        .stat-card.clickable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-color: #2563eb;
        }

        .stat-card.clickable:active {
            transform: translateY(0);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .stat-info span {
            display: block;
            color: #6b7280;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.2rem;
        }

        .stat-info h4 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
            line-height: 1;
        }

        /* 審題狀態圖示顏色 */
        .icon-gray {
            background-color: #f3f4f6;
            color: #6b7280;
        }

        .icon-purple {
            background-color: #f3e8ff;
            color: #8b5cf6;
        }

        .icon-orange {
            background-color: #fff7ed;
            color: #f97316;
        }

        .icon-red {
            background-color: #fef2f2;
            color: #ef4444;
        }

        .icon-green {
            background-color: #f0fdf4;
            color: #10b981;
        }

        /* 表格樣式 */
        .custom-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }

        .custom-table th {
            background-color: #f3f4f6;
            color: #374151;
            font-weight: 700;
            padding: 1rem;
            font-size: 0.9rem;
            border-bottom: 2px solid #e5e7eb;
            text-align: left;
        }

        .custom-table td {
            padding: 1rem;
            vertical-align: middle;
            border-bottom: 1px solid #f3f4f6;
            color: #4b5563;
            font-size: 0.95rem;
        }

        .custom-table tr:hover td {
            background-color: #f9fafb;
        }

        /* 審題狀態徽章 */
        .badge-outline {
            padding: 0.35em 0.8em;
            border-radius: 50rem;
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 1px solid transparent;
        }

        .badge-outline::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        /* 互審中 - 紫色 */
        .badge-mutual {
            background-color: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
            border-color: rgba(139, 92, 246, 0.2);
        }

        .badge-mutual::before {
            background-color: #8b5cf6;
        }

        /* 專審中 - 橙色 */
        .badge-expert {
            background-color: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.2);
        }

        .badge-expert::before {
            background-color: #f59e0b;
        }

        /* 總審中 - 紅色 */
        .badge-final {
            background-color: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.2);
        }

        .badge-final::before {
            background-color: #ef4444;
        }

        /* 已完成 - 綠色 */
        .badge-completed {
            background-color: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.2);
        }

        .badge-completed::before {
            background-color: #10b981;
        }

        /* 操作連結 */
        .action-links a,
        .action-links button {
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .action-links a:hover,
        .action-links button:hover {
            text-decoration: underline;
        }

        /* 分頁 */
        .pagination-container {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-top: 1rem;
            gap: 10px;
        }

        .page-info {
            color: #6b7280;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .page-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            color: #6b7280;
            text-decoration: none;
            background: white;
            font-size: 0.9rem;
        }

        .page-btn.active {
            background-color: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .page-btn:hover:not(.active) {
            background-color: #f3f4f6;
        }

        /* 表格工具列 */
        .table-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
        }

        /* === 審題 Modal 專用樣式 === */
        #reviewModal .modal-content {
            background: #f8fafc;
            border: none;
            border-radius: 16px !important;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        /* Modal Header - 根據審題狀態變色 */
        #reviewModal .modal-header {
            padding: 1.25rem 1.5rem;
            border-bottom: none !important;
            position: relative;
            overflow: hidden;
        }

        #reviewModal .modal-header.review-mutual {
            background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 50%, #a78bfa 100%);
        }

        #reviewModal .modal-header.review-expert {
            background: linear-gradient(135deg, #d97706 0%, #f59e0b 50%, #fbbf24 100%);
        }

        #reviewModal .modal-header.review-final {
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 50%, #f87171 100%);
        }

        #reviewModal .modal-title {
            color: #ffffff;
            font-weight: 700;
            font-size: 1.35rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        #reviewModal .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
        }

        #reviewModal .btn-close:hover {
            opacity: 1;
        }

        /* Modal Body */
        #reviewModal .modal-body {
            background: linear-gradient(180deg, #f1f5f9 0%, #f8fafc 30%, #ffffff 100%);
            padding: 1.5rem;
            max-height: 70vh;
            overflow-y: auto;
        }

        /* 區塊卡片 */
        #reviewModal .section-card {
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            border: 1px solid rgba(37, 99, 235, 0.12);
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(37, 99, 235, 0.08);
            padding: 1.25rem;
            margin-bottom: 1.25rem;
            position: relative;
            overflow: hidden;
        }

        #reviewModal .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #3b82f6 0%, #06b6d4 100%);
            border-radius: 12px 0 0 12px;
        }

        /* 唯讀區塊樣式 */
        #reviewModal .section-card.readonly-section {
            background: linear-gradient(145deg, #f8fafc 0%, #f1f5f9 100%);
        }

        #reviewModal .section-card.readonly-section::before {
            background: linear-gradient(180deg, #94a3b8 0%, #cbd5e1 100%);
        }

        /* 互審意見區塊 */
        #reviewModal .section-card.mutual-section::before {
            background: linear-gradient(180deg, #8b5cf6 0%, #a78bfa 100%);
        }

        /* 專審意見區塊 */
        #reviewModal .section-card.expert-section::before {
            background: linear-gradient(180deg, #f59e0b 0%, #fbbf24 100%);
        }

        /* 總審意見區塊 */
        #reviewModal .section-card.final-section::before {
            background: linear-gradient(180deg, #ef4444 0%, #f87171 100%);
        }

        /* 區塊標題 */
        #reviewModal .section-title {
            color: #1e40af;
            font-size: 1rem;
            font-weight: 700;
            padding-left: 0.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid transparent;
            border-image: linear-gradient(90deg, #3b82f6 0%, #06b6d4 50%, transparent 100%) 1;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* 只針對 section 標題前面的圖示，不影響 badge 內的圖示 */
        #reviewModal .section-title>i {
            color: #3b82f6;
            font-size: 1.1rem;
        }

        /* 唯讀內容區 */
        .readonly-content {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            color: #475569;
            line-height: 1.8;
            min-height: 100px;
        }

        .readonly-content.opinion-box {
            min-height: 80px;
            background-color: #fefce8;
            border-color: #fef08a;
        }

        /* 表單標籤 */
        #reviewModal .form-label {
            color: #475569;
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        /* 意見輸入區 */
        #reviewModal .opinion-textarea {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.95rem;
            min-height: 120px;
            resize: vertical;
            transition: all 0.2s ease;
        }

        #reviewModal .opinion-textarea:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
            outline: none;
        }

        /* 必填星號 */
        .required-star::after {
            content: " *";
            color: #dc3545;
        }

        /* Modal Footer */
        #reviewModal .modal-footer {
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 1rem 1.5rem;
            border-top: 1px solid #e2e8f0;
            gap: 0.75rem;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        /* 審題決策按鈕 */
        .review-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn-adopt {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 4px 14px rgba(16, 185, 129, 0.35);
            transition: all 0.2s;
        }

        .btn-adopt:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.45);
            color: white;
        }

        .btn-adopt-modify {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            border: none;
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 4px 14px rgba(245, 158, 11, 0.35);
            transition: all 0.2s;
        }

        .btn-adopt-modify:hover {
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.45);
            color: white;
        }

        .btn-reject {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border: none;
            padding: 0.6rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 4px 14px rgba(239, 68, 68, 0.35);
            transition: all 0.2s;
        }

        .btn-reject:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.45);
            color: white;
        }

        /* 快速插入按鈕 */
        .quick-insert-btns {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .quick-insert-btns .btn {
            font-size: 0.8rem;
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            transition: all 0.2s;
        }

        .quick-insert-btns .btn:hover {
            background: #6b7280;
            color: white;
            border-color: #6b7280;
        }

        /* 題目資訊區 */
        .question-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: #f1f5f9;
            border-radius: 8px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .meta-label {
            color: #64748b;
            font-weight: 500;
        }

        .meta-value {
            color: #1e293b;
            font-weight: 600;
        }

        /* 選項顯示區 */
        .option-display {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .option-display.correct-answer {
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            border-color: #86efac;
        }

        .option-label {
            flex-shrink: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #e5e7eb;
            color: #374151;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.85rem;
        }

        .option-display.correct-answer .option-label {
            background: #10b981;
            color: white;
        }

        .option-content {
            flex: 1;
            color: #334155;
            line-height: 1.6;
        }

        /* 審題歷程 */
        .review-history {
            margin-top: 1rem;
        }

        .history-item {
            display: flex;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px dashed #e5e7eb;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-stage {
            flex-shrink: 0;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .history-stage.mutual {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
        }

        .history-stage.expert {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }

        .history-stage.final {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .history-content {
            flex: 1;
        }

        .history-reviewer {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }

        .history-text {
            color: #64748b;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .history-time {
            color: #94a3b8;
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        /* 命題者隱藏顯示 */
        .proposer-hidden {
            color: #94a3b8;
            font-style: italic;
        }

        /* Tab 切換區 */
        .review-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0;
        }

        .review-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: #6b7280;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .review-tab:hover {
            color: #374151;
            background: #f9fafb;
        }

        .review-tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .review-tab .badge {
            margin-left: 0.5rem;
            font-size: 0.75rem;
        }

        /* 響應式 */
        @media (max-width: 768px) {
            .review-actions {
                width: 100%;
                justify-content: center;
            }

            .review-actions .btn {
                flex: 1;
            }

            #reviewModal .modal-footer {
                flex-direction: column;
            }
        }

        /* 互動式統計圖示 */
        .stat-icon.interactive {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-icon.interactive:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* 懸浮效果 */
        .hover-effect:active {
            transform: scale(0.9);
        }
    </style>
</head>

<body>
    <nav class="top-navbar">
        <div class="container-fluid px-4">
            <div class="row align-items-center">
                <div class="col-3">
                    <a href="firstpage.html" class="navbar-brand">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                        </svg>
                        CWT 命題工作平臺
                    </a>
                </div>

                <div class="col-6 d-flex justify-content-center">
                    <div class="project-switcher">
                        <div class="project-display glass-enhanced" id="projectToggle">
                            <div class="glass-icon">
                                <img src="ICON/calendar.svg" alt="Calendar" style="width: 24px; height: 24px;">
                            </div>

                            <div class="project-info">
                                <div class="project-year" id="currentProjectYear">
                                    2024年度
                                </div>
                                <div class="project-name" id="currentProjectName">
                                    進行中梯次範例一
                                </div>
                            </div>
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path
                                    d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z" />
                            </svg>
                        </div>

                        <div class="project-dropdown" id="projectDropdown">
                            <div class="dropdown-header">
                                <span>切換專案</span>
                                <button class="close-btn" id="closeDropdown">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z" />
                                    </svg>
                                </button>
                            </div>

                            <div class="project-search">
                                <input type="text" placeholder="搜尋專案名稱..." id="projectSearchInput" />
                            </div>

                            <div class="project-list" id="projectList">
                                <div class="project-category">進行中 (3)</div>

                                <div class="project-item active" data-project-id="1" data-year="2024"
                                    data-name="進行中梯次範例一" data-role="admin">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-active"></span>
                                            進行中梯次範例一
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2024年度</span>
                                            <span>截止: 2024/12/31</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-admin">系統管理員</span>
                                </div>

                                <div class="project-item" data-project-id="2" data-year="2024" data-name="進行中梯次範例二"
                                    data-role="reviewer">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-active"></span>
                                            進行中梯次範例二
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2024年度</span>
                                            <span>截止: 2024/11/15</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-reviewer">審題委員</span>
                                </div>

                                <div class="project-item" data-project-id="3" data-year="2024" data-name="進行中梯次範例三"
                                    data-role="teacher">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-active"></span>
                                            進行中梯次範例三
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2024年度</span>
                                            <span>截止: 2025/01/20</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-teacher">命題教師</span>
                                </div>

                                <div class="project-category">已結束 (5)</div>

                                <div class="project-item" data-project-id="4" data-year="2023" data-name="已結束梯次範例一"
                                    data-role="admin">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-finished"></span>
                                            已結束梯次範例一
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2023年度</span>
                                            <span>已結束</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-admin">系統管理員</span>
                                </div>

                                <div class="project-item" data-project-id="5" data-year="2023" data-name="已結束梯次範例二"
                                    data-role="teacher">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-finished"></span>
                                            已結束梯次範例二
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2023年度</span>
                                            <span>已結束</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-teacher">命題教師</span>
                                </div>

                                <div class="project-item" data-project-id="6" data-year="2023" data-name="已結束梯次範例三"
                                    data-role="reviewer">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-finished"></span>
                                            已結束梯次範例三
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2023年度</span>
                                            <span>已結束</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-reviewer">審題委員</span>
                                </div>

                                <div class="project-item" data-project-id="7" data-year="2022" data-name="已結束梯次範例四"
                                    data-role="teacher">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-finished"></span>
                                            已結束梯次範例四
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2022年度</span>
                                            <span>已結束</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-teacher">命題教師</span>
                                </div>

                                <div class="project-item" data-project-id="8" data-year="2022" data-name="已結束梯次範例五"
                                    data-role="teacher">
                                    <div class="project-item-info">
                                        <div class="project-item-title">
                                            <span class="status-indicator status-finished"></span>
                                            已結束梯次範例五
                                        </div>
                                        <div class="project-item-meta">
                                            <span>2022年度</span>
                                            <span>已結束</span>
                                        </div>
                                    </div>
                                    <span class="role-badge role-teacher">命題教師</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-3">
                    <div class="user-section">
                        <div class="user-info">
                            <div class="user-avatar">沈</div>
                            <span class="user-name">沈雅茹</span>
                            <span class="role-badge role-admin" id="currentUserRole">系統管理員</span>
                        </div>
                        <a href="index.html" class="btn btn-sm btn-light fw-bold text-primary px-3">
                            登出
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Breadcrumb Bar (Matching cwt-list.html) -->
    <div class="breadcrumb-bar">
        <div class="container-fluid px-4 d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <a href="firstpage.html" class="breadcrumb-item-link">首頁</a>
                <span class="breadcrumb-separator">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"
                        stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6"></polyline>
                    </svg>
                </span>
                <span class="breadcrumb-current">審題清單</span>
            </div>

            <!-- Text Size Controls (Optional, keeping consistent if desired) -->
            <div class="bg-white rounded-pill px-2 py-1 border d-flex align-items-center shadow-sm"
                style="width: fit-content;">
                <span class="text-muted d-flex align-items-center me-2 border-end pe-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                        class="bi bi-type" viewBox="0 0 16 16">
                        <path
                            d="m2.244 13.081.943-2.803H6.66l.944 2.803H8.86L5.54 3.75H4.322L1 13.081zm2.7-7.923L6.34 9.314H3.51l1.4-4.156zm9.146 7.027h.035v.896h1.128V8.125c0-1.51-1.114-2.345-2.646-2.345-1.736 0-2.59.916-2.666 2.174h1.108c.068-.718.595-1.19 1.517-1.19.971 0 1.518.52 1.518 1.464v.731H12.19c-1.647.007-2.522.8-2.522 2.058 0 1.319.957 2.18 2.345 2.18 1.06 0 1.716-.43 2.078-1.011zm-1.763.035c-.752 0-1.456-.397-1.456-1.244 0-.65.424-1.115 1.408-1.115h1.805v.834c0 .896-.752 1.525-1.757 1.525" />
                    </svg>
                </span>
                <button
                    class="btn btn-sm bg-transparent border-0 p-0 rounded-circle d-flex align-items-center justify-content-center hover-effect"
                    style="width: 32px; height: 32px; transition: transform 0.1s;" onclick="changeFontSize(-1)"
                    title="縮小">
                    <img src="ICON/minus.png" alt="縮小" style="width: 26px; height: auto;">
                </button>
                <span class="small fw-bold text-secondary mx-2 user-select-none"
                    style="cursor: pointer; min-width: 45px; text-align: center; transition: color 0.3s;"
                    onclick="resetFontSize()" id="fontSizeDisplay" title="點擊還原預設值">
                    100%
                </span>
                <button
                    class="btn btn-sm bg-transparent border-0 p-0 rounded-circle d-flex align-items-center justify-content-center hover-effect"
                    style="width: 32px; height: 32px; transition: transform 0.1s;" onclick="changeFontSize(1)"
                    title="放大">
                    <img src="ICON/add.png" alt="放大" style="width: 28px; height: auto;">
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <!-- 主要內容區 -->
    <div class="main-content">
        <div class="container px-4">
            <h1 class="page-title">審題清單</h1>
            <p class="page-desc">
                檢視並審核指派給您的試題，包括互審、專審與總審階段的題目。
            </p>

            <!-- 搜尋篩選區 -->
            <div class="card-box search-area">
                <div class="row g-3 align-items-end">
                    <div class="col-md-2">
                        <label class="form-label">審題狀態</label>
                        <select class="form-select" id="filterReviewStatus">
                            <option value="all" selected>全部狀態</option>
                            <option value="互審中">互審中</option>
                            <option value="專審中">專審中</option>
                            <option value="總審中">總審中</option>
                        </select>
                    </div>

                    <div class="col-md-2">
                        <label class="form-label">題型篩選</label>
                        <select class="form-select" id="filterType">
                            <option value="all" selected>全部題型</option>
                            <option value="一般題目">一般題目</option>
                            <option value="精選題目">精選題目</option>
                            <option value="閱讀題組">閱讀題組</option>
                            <option value="短文題組">短文題組</option>
                            <option value="長文題目">長文題目</option>
                            <option value="聽力題目">聽力題目</option>
                            <option value="聽力題組">聽力題組</option>
                        </select>
                    </div>

                    <div class="col-md-2">
                        <label class="form-label">等級篩選</label>
                        <select class="form-select" id="filterLevel">
                            <option value="all" selected>全部等級</option>
                            <option value="初級">初級</option>
                            <option value="中級">中級</option>
                            <option value="中高級">中高級</option>
                            <option value="高級">高級</option>
                            <option value="優級">優級</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">關鍵字搜尋</label>
                        <div class="d-flex gap-2">
                            <div class="input-group">
                                <span class="input-group-text bg-white text-secondary border-end-0">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                </span>
                                <input type="text" id="searchInput" class="form-control border-start-0 ps-2"
                                    placeholder="依題目內容搜尋..." />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 操作提示 -->
            <div class="alert alert-info alert-dismissible fade show d-flex align-items-center mb-4 shadow-sm"
                role="alert" style="border-left: 5px solid #0dcaf0;">
                <svg xmlns="http://www.w3.org/2000/svg" class="bi flex-shrink-0 me-3" width="24" height="24"
                    fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z" />
                </svg>
                <div>
                    <strong>操作提示：</strong>
                    點擊下方統計卡片可快速篩選對應審題狀態。
                    <span class="badge bg-secondary ms-1">待審總計</span> 顯示全部題目、
                    <span class="badge" style="background: #8b5cf6;">互審中</span>
                    <span class="badge" style="background: #f59e0b;">專審中</span>
                    <span class="badge" style="background: #ef4444;">總審中</span>
                    分別篩選各審題階段。
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>

            <!-- 統計卡片 -->
            <div class="row g-4 mb-4">
                <div class="col-md-3">
                    <div class="stat-card clickable" onclick="filterByStatus('all')" title="顯示全部待審題目"
                        style="cursor: pointer;">
                        <div class="stat-icon icon-gray">
                            <i class="bi bi-clipboard-check fs-4"></i>
                        </div>
                        <div class="stat-info">
                            <span>待審總計</span>
                            <h4 id="stat-total">8</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card clickable" onclick="filterByStatus('互審中')" title="篩選互審中題目"
                        style="cursor: pointer;">
                        <div class="stat-icon icon-purple">
                            <i class="bi bi-people fs-4"></i>
                        </div>
                        <div class="stat-info">
                            <span>互審中</span>
                            <h4 id="stat-mutual">3</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card clickable" onclick="filterByStatus('專審中')" title="篩選專審中題目"
                        style="cursor: pointer;">
                        <div class="stat-icon icon-orange">
                            <i class="bi bi-person-badge fs-4"></i>
                        </div>
                        <div class="stat-info">
                            <span>專審中</span>
                            <h4 id="stat-expert">3</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card clickable" onclick="filterByStatus('總審中')" title="篩選總審中題目"
                        style="cursor: pointer;">
                        <div class="stat-icon icon-red">
                            <i class="bi bi-shield-check fs-4"></i>
                        </div>
                        <div class="stat-info">
                            <span>總審中</span>
                            <h4 id="stat-final">2</h4>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 審題列表 -->
            <div class="card-box">
                <div class="table-toolbar">
                    <div class="d-flex align-items-center gap-3">
                        <span class="text-secondary small">
                            <i class="bi bi-info-circle me-1"></i>
                            共 <strong id="visibleCount">8</strong> 筆待審題目
                        </span>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="custom-table">
                        <thead>
                            <tr>
                                <th style="width: 40%">題目摘要</th>
                                <th>等級</th>
                                <th>題型</th>
                                <th>審題狀態</th>
                                <th>命題者</th>
                                <th>送審時間</th>
                                <th style="width: 100px">操作</th>
                            </tr>
                        </thead>
                        <tbody id="reviewTableBody">
                            <!-- 互審中 - 範例1 -->
                            <tr class="data-row" data-status="互審中" data-type="一般題目" data-level="初級">
                                <td class="text-dark fw-medium">
                                    下列「」中的注音，何者正確？<br>
                                    <small class="text-muted">題幹：(A)「踽」踽獨行 (B)「躊」躇滿志...</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">初級</span></td>
                                <td>一般題目</td>
                                <td><span class="badge-outline badge-mutual">互審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-28 10:30</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'mutual')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 互審中 - 範例2 -->
                            <tr class="data-row" data-status="互審中" data-type="精選題目" data-level="中級">
                                <td class="text-dark fw-medium">
                                    「醉翁之意不在酒」使用了哪種修辭技巧？<br>
                                    <small class="text-muted">題幹：(A)誇飾 (B)轉化 (C)借代 (D)映襯</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">中級</span></td>
                                <td>精選題目</td>
                                <td><span class="badge-outline badge-mutual">互審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-28 11:15</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'mutual')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 互審中 - 範例3 -->
                            <tr class="data-row" data-status="互審中" data-type="閱讀題組" data-level="中高級">
                                <td class="text-dark fw-medium">
                                    [閱讀題組] 閱讀下列短文，回答問題...<br>
                                    <small class="text-muted">包含 3 個子題</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">中高級</span></td>
                                <td>閱讀題組</td>
                                <td><span class="badge-outline badge-mutual">互審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-27 16:20</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'mutual')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 專審中 - 範例1 -->
                            <tr class="data-row" data-status="專審中" data-type="一般題目" data-level="高級">
                                <td class="text-dark fw-medium">
                                    下列文句的語氣，何者與其他三者不同？<br>
                                    <small class="text-muted">題幹：(A)多麼美好的一天啊 (B)這是誰的傑作...</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">高級</span></td>
                                <td>一般題目</td>
                                <td><span class="badge-outline badge-expert">專審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-26 09:45</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'expert')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 專審中 - 範例2 -->
                            <tr class="data-row" data-status="專審中" data-type="聽力題目" data-level="中級">
                                <td class="text-dark fw-medium">
                                    [聽力] 請聽完錄音後，選出最適當的回應...<br>
                                    <small class="text-muted">語音類型：對話 | 素材：生活</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">中級</span></td>
                                <td>聽力題目</td>
                                <td><span class="badge-outline badge-expert">專審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-26 14:30</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'expert')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 專審中 - 範例3 -->
                            <tr class="data-row" data-status="專審中" data-type="短文題組" data-level="中高級">
                                <td class="text-dark fw-medium">
                                    [短文題組] 根據以下圖表資料，回答問題...<br>
                                    <small class="text-muted">包含 3 個子題</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">中高級</span></td>
                                <td>短文題組</td>
                                <td><span class="badge-outline badge-expert">專審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-25 11:00</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'expert')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 總審中 - 範例1 -->
                            <tr class="data-row" data-status="總審中" data-type="精選題目" data-level="優級">
                                <td class="text-dark fw-medium">
                                    下列對於「賦」這種文體的敘述，何者錯誤？<br>
                                    <small class="text-muted">題幹：(A)源於詩經 (B)講究聲韻對仗...</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">優級</span></td>
                                <td>精選題目</td>
                                <td><span class="badge-outline badge-final">總審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-24 08:15</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'final')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 總審中 - 範例2 -->
                            <tr class="data-row" data-status="總審中" data-type="長文題目" data-level="高級">
                                <td class="text-dark fw-medium">
                                    [長文] 請以「科技與人文的平衡」為題，撰寫一篇論說文...<br>
                                    <small class="text-muted">字數要求：800-1000字</small>
                                </td>
                                <td><span class="badge bg-light text-dark border">高級</span></td>
                                <td>長文題目</td>
                                <td><span class="badge-outline badge-final">總審中</span></td>
                                <td><span class="proposer-hidden">***（隱藏）</span></td>
                                <td>2026-01-23 15:40</td>
                                <td class="action-links">
                                    <button class="btn btn-link p-0 text-decoration-none fw-bold text-primary"
                                        onclick="openReviewModal(this, 'final')">
                                        <i class="bi bi-pencil-square me-1"></i>審題
                                    </button>
                                </td>
                            </tr>

                            <!-- 無資料列 -->
                            <tr id="noDataRow" style="display: none">
                                <td colspan="7" class="text-center py-5 text-secondary">
                                    <div class="d-flex flex-column align-items-center opacity-50">
                                        <i class="bi bi-inbox fs-1 mb-2"></i>
                                        <h6 class="fw-bold mt-2">沒有符合的審題項目</h6>
                                        <p class="small">請嘗試調整篩選條件</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 分頁 -->
                    <div class="pagination-container">
                        <span class="page-info">第 1 頁 / 共 1 頁</span>
                        <a href="#" class="page-btn disabled">&lt;</a>
                        <a href="#" class="page-btn active">1</a>
                        <a href="#" class="page-btn">&gt;</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 審題 Modal -->
    <div class="modal fade" id="reviewModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content border-0 rounded-4 shadow">

                <!-- Modal Header - 會根據審題狀態變色 -->
                <div class="modal-header review-mutual" id="reviewModalHeader">
                    <h5 class="modal-title" id="reviewModalTitle">
                        <i class="bi bi-clipboard-check"></i>
                        審題 - 互審階段
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body pt-0">
                    <!-- 題目狀態資訊列 -->
                    <div class="question-meta mt-3">
                        <div class="meta-item">
                            <span class="meta-label">題型：</span>
                            <span class="meta-value" id="reviewQuestionType">一般題目</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">等級：</span>
                            <span class="meta-value" id="reviewQuestionLevel">初級</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">命題者：</span>
                            <span class="meta-value proposer-hidden">***（隱藏）</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">送審時間：</span>
                            <span class="meta-value" id="reviewSubmitTime">2026-01-28 10:30</span>
                        </div>
                    </div>

                    <!-- 一、題目內容（唯讀）-->
                    <div class="section-card readonly-section">
                        <h6 class="section-title">
                            <i class="bi bi-file-text"></i>
                            一、題目內容
                            <span class="badge bg-primary text-white ms-2"><i class="bi bi-lock-fill me-1"></i>唯讀</span>
                        </h6>

                        <div class="mb-3">
                            <label class="form-label fw-bold small text-secondary">題幹</label>
                            <div class="readonly-content" id="reviewQuestionContent">
                                <p>下列「」中的注音，何者正確？</p>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-bold small text-secondary">選項</label>
                            <div id="reviewOptionsContainer">
                                <div class="option-display">
                                    <span class="option-label">A</span>
                                    <span class="option-content">「踽」踽獨行：ㄐㄩˇ</span>
                                </div>
                                <div class="option-display correct-answer">
                                    <span class="option-label">B</span>
                                    <span class="option-content">「躊」躇滿志：ㄔㄡˊ <small
                                            class="text-success fw-bold">（正確答案）</small></span>
                                </div>
                                <div class="option-display">
                                    <span class="option-label">C</span>
                                    <span class="option-content">「躑」躅不前：ㄓˊ</span>
                                </div>
                                <div class="option-display">
                                    <span class="option-label">D</span>
                                    <span class="option-content">「蹣」跚學步：ㄇㄢˊ</span>
                                </div>
                            </div>
                        </div>

                        <div class="mb-0">
                            <label class="form-label fw-bold small text-secondary">參考答案與解析</label>
                            <div class="readonly-content" id="reviewExplanation">
                                <p><strong>正確答案：B</strong></p>
                                <p>解析：</p>
                                <ul>
                                    <li>(A)「踽」踽獨行：應讀作 ㄐㄩˇ，正確。</li>
                                    <li>(B)「躊」躇滿志：讀作 ㄔㄡˊ，正確。此為正解。</li>
                                    <li>(C)「躑」躅不前：應讀作 ㄓˊ，誤。正確讀音為 ㄓˊ。</li>
                                    <li>(D)「蹣」跚學步：應讀作 ㄆㄢˊ，誤。題目標示 ㄇㄢˊ 為錯誤。</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 二、互審意見 -->
                    <div class="section-card mutual-section" id="mutualOpinionSection">
                        <h6 class="section-title">
                            <i class="bi bi-people"></i>
                            二、互審意見
                            <span class="badge bg-purple text-white ms-2" id="mutualOpinionBadge"><i
                                    class="bi bi-pen-fill me-1"></i>必填</span>
                        </h6>

                        <!-- 互審中：可編輯 -->
                        <div id="mutualOpinionEdit">
                            <label class="form-label fw-bold small text-secondary required-star">審題意見</label>
                            <div class="quill-master-container border rounded">
                                <!-- 標點符號工具列 -->
                                <div
                                    class="punctuation-toolbar d-flex flex-wrap gap-2 p-2 border-bottom bg-light rounded-top">
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="，">，</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="。">。</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="、">、</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="？">？</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="！">！</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="：">：</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="；">；</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="「」" data-back="1">「」</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="『』" data-back="1">『』</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="（）" data-back="1">（）</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="【】" data-back="1">【】</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="……">……</button>
                                </div>
                                <!-- Quill 編輯器 -->
                                <div id="mutualOpinionEditor" style="min-height: 120px;"></div>
                                <!-- 字數統計 -->
                                <div
                                    class="word-count-bar d-flex justify-content-between align-items-center p-2 border-top bg-light small text-secondary rounded-bottom">
                                    <span>字數：<span class="count-num" id="count-mutualOpinion">0</span></span>
                                </div>
                            </div>
                            <div class="quick-insert-btns mt-2">
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('mutualOpinion', '題幹敘述需修正，請確認語句通順與邏輯正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>題幹需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('mutualOpinion', '選項內容需調整，請檢視選項間的鑑別度及正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>選項需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('mutualOpinion', '題目與指定題型不符，請重新確認題型設定。')">
                                    <i class="bi bi-chat-quote me-1"></i>題型不符
                                </button>
                            </div>
                            <div class="form-text small mt-1">
                                <i class="bi bi-info-circle me-1"></i>
                                請具體說明審查意見，作為命題者修改參考
                            </div>
                        </div>

                        <!-- 專審/總審時：唯讀顯示 -->
                        <div id="mutualOpinionReadonly" class="d-none">
                            <label class="form-label fw-bold small text-secondary">互審委員意見</label>
                            <div class="readonly-content opinion-box" id="mutualOpinionDisplay">
                                <p><strong>王審委</strong> <small class="text-muted">2026-01-28 14:30</small></p>
                                <p>題目設計良好，選項具鑑別度。建議選項(C)的注音標示可再確認。</p>
                            </div>
                        </div>
                    </div>

                    <!-- 三、專審意見 -->
                    <div class="section-card expert-section d-none" id="expertOpinionSection">
                        <h6 class="section-title">
                            <i class="bi bi-person-badge"></i>
                            三、專審意見
                            <span class="badge bg-warning text-white ms-2" id="expertOpinionBadge"><i
                                    class="bi bi-pen-fill me-1"></i>必填</span>
                        </h6>

                        <!-- 專審中：可編輯 -->
                        <div id="expertOpinionEdit">
                            <label class="form-label fw-bold small text-secondary required-star">審題意見</label>
                            <div class="quill-master-container border rounded">
                                <!-- 標點符號工具列 -->
                                <div
                                    class="punctuation-toolbar d-flex flex-wrap gap-2 p-2 border-bottom bg-light rounded-top">
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="，">，</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="。">。</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="、">、</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="？">？</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="！">！</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="：">：</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="；">；</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="「」" data-back="1">「」</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="『』" data-back="1">『』</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="（）" data-back="1">（）</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="【】" data-back="1">【】</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="……">……</button>
                                </div>
                                <!-- Quill 編輯器 -->
                                <div id="expertOpinionEditor" style="min-height: 120px;"></div>
                                <!-- 字數統計 -->
                                <div
                                    class="word-count-bar d-flex justify-content-between align-items-center p-2 border-top bg-light small text-secondary rounded-bottom">
                                    <span>字數：<span class="count-num" id="count-expertOpinion">0</span></span>
                                </div>
                            </div>
                            <div class="quick-insert-btns mt-2">
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('expertOpinion', '題幹敘述需修正，請確認語句通順與邏輯正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>題幹需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('expertOpinion', '選項內容需調整，請檢視選項間的鑑別度及正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>選項需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('expertOpinion', '題目與指定題型不符，請重新確認題型設定。')">
                                    <i class="bi bi-chat-quote me-1"></i>題型不符
                                </button>
                            </div>
                            <div class="form-text small mt-1">
                                <i class="bi bi-info-circle me-1"></i>
                                請從專業角度審查題目內容的正確性
                            </div>
                        </div>

                        <!-- 總審時：唯讀顯示 -->
                        <div id="expertOpinionReadonly" class="d-none">
                            <label class="form-label fw-bold small text-secondary">專審委員意見</label>
                            <div class="readonly-content opinion-box" id="expertOpinionDisplay">
                                <p><strong>陳教授</strong> <small class="text-muted">2026-01-27 09:15</small></p>
                                <p>經專業審查，題目內容正確無誤。建議微調題幹敘述使其更為精準。</p>
                            </div>
                        </div>
                    </div>

                    <!-- 四、總審意見 -->
                    <div class="section-card final-section d-none" id="finalOpinionSection">
                        <h6 class="section-title">
                            <i class="bi bi-shield-check"></i>
                            四、總審意見
                            <span class="badge bg-danger text-white ms-2" id="finalOpinionBadge"><i
                                    class="bi bi-pen-fill me-1"></i>必填</span>
                        </h6>

                        <div id="finalOpinionEdit">
                            <label class="form-label fw-bold small text-secondary required-star">審題意見</label>
                            <div class="quill-master-container border rounded">
                                <!-- 標點符號工具列 -->
                                <div
                                    class="punctuation-toolbar d-flex flex-wrap gap-2 p-2 border-bottom bg-light rounded-top">
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="，">，</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="。">。</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="、">、</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="？">？</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="！">！</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="：">：</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="；">；</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="「」" data-back="1">「」</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="『』" data-back="1">『』</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="（）" data-back="1">（）</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="【】" data-back="1">【】</button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary punc-btn"
                                        data-char="……">……</button>
                                </div>
                                <!-- Quill 編輯器 -->
                                <div id="finalOpinionEditor" style="min-height: 120px;"></div>
                                <!-- 字數統計 -->
                                <div
                                    class="word-count-bar d-flex justify-content-between align-items-center p-2 border-top bg-light small text-secondary rounded-bottom">
                                    <span>字數：<span class="count-num" id="count-finalOpinion">0</span></span>
                                </div>
                            </div>
                            <div class="quick-insert-btns mt-2">
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('finalOpinion', '題幹敘述需修正，請確認語句通順與邏輯正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>題幹需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('finalOpinion', '選項內容需調整，請檢視選項間的鑑別度及正確性。')">
                                    <i class="bi bi-chat-quote me-1"></i>選項需修正
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"
                                    onclick="insertQuickTextQuill('finalOpinion', '題目與指定題型不符，請重新確認題型設定。')">
                                    <i class="bi bi-chat-quote me-1"></i>題型不符
                                </button>
                            </div>
                            <div class="form-text small mt-1">
                                <i class="bi bi-info-circle me-1"></i>
                                請綜合評估題目整體品質，做出最終審題決策
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Modal Footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                        <i class="bi bi-x-lg me-1"></i>取消
                    </button>

                    <div class="review-actions">
                        <button type="button" class="btn btn-adopt" onclick="submitReview('adopt')">
                            <i class="bi bi-check-circle me-1"></i>採用
                        </button>
                        <button type="button" class="btn btn-adopt-modify" onclick="submitReview('adopt-modify')">
                            <i class="bi bi-pencil me-1"></i>改後採用
                        </button>
                        <button type="button" class="btn btn-reject" onclick="submitReview('reject')">
                            <i class="bi bi-x-circle me-1"></i>不採用
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Toast 通知 -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1060;">
        <div id="liveToast" class="toast align-items-center text-white border-0" role="alert" aria-live="assertive"
            aria-atomic="true">
            <div class="d-flex">
                <div class="toast-body"></div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="js/quill.min.js"></script>
    <!-- 審題頁面專用邏輯 -->
    <script src="js/review.js"></script>
</body>

</html>